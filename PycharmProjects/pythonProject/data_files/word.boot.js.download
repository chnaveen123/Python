var Microsoft="object"==typeof Microsoft?Microsoft:{};Microsoft.Office=Microsoft.Office||{},Microsoft.Office.Word=function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=107)}([function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),function(t){t[t.O=0]="msoulscat_ES_EWAJS",t[t._=1]="msoulscat_ES_EWAJSGrid",t[t.P=6]="msoulscat_ES_EWAJSChart",t[t.R=202]="msoulscat_MSOSP_FileMenuCommands",t[t.A=225]="msoulscat_MSOSP_OTelJS",t[t.U=227]="msoulscat_MSOSP_OTelJSInWebWoker",t[t.F=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",t[t.N=301]="msoulscat_Wac_WordViewer",t[t.H=306]="msoulscat_Wac_BrowserGeneral",t[t.J=320]="msoulscat_Wac_TaskPane",t[t.B=339]="msoulscat_Wac_OneNoteGeneral",t[t.K=340]="msoulscat_Wac_Ribbon",t[t.Z=379]="msoulscat_Wac_WopiPendingApplication",t[t.$=383]="msoulscat_Wac_Telemetry",t[t.X=391]="msoulscat_Wac_WacCatchUpActivities",t[t.Y=394]="msoulscat_Wac_Dictation",t[t.tt=395]="msoulscat_Wac_OneNoteSync",t[t.et=700]="msoulscat_Wac_VisioApp",t[t.nt=1601]="msoulscat_OneNoteOnline_EditableCache",t[t.it=800]="msoulscat_Wac_PptAnimation",t[t.ot=833]="msoulscat_Wac_PptLive",t[t.rt=834]="msoulscat_Wac_PptMWeb",t[t.st=815]="msoulscat_Wac_PptShape",t[t.ct=817]="msoulscat_Wac_PptSession",t[t.at=830]="msoulscat_Wac_PptSlideshow",t[t.ut=822]="msoulscat_Wac_PptView",t[t.ft=2300]="msoulscat_Wac_VersionHistory",t[t.dt=302]="msoulscat_Wac_WordPresence",t[t.ht=3005]="msoulscat_Wac_WordVersionHistory",t[t.lt=3006]="msoulscat_Wac_LivePersonaCard",t[t.pt=3012]="msoulscat_Wac_CatchUpFlyout",t[t.vt=3016]="msoulscat_Wac_WordDesigner",t[t.bt=3021]="msoulscat_Wac_ModernFontPicker",t[t.Ot=3027]="msoulscat_Wac_UnifiedUiHost",t[t.wt=3033]="msoulscat_Wac_EquationTools"}(i||(i={}))},function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),function(t){t[t.Error=10]="Error",t[t.Warning=15]="Warning",t[t.Info=50]="Info",t[t.Verbose=100]="Verbose",t[t.Spam=200]="Spam"}(i||(i={}))},function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),function(t){t.BrowserEvent="BrowserEvent",t.PageChanged="PageChanged",t.ZoomChanged="ZoomChanged",t.ContentRefreshBegin="ContentRefreshBegin",t.ContentRefreshEnd="ContentRefreshEnd",t.AppClosed="UI_Close",t.UserEdit="Edit_Notification",t.FileRename="File_Rename",t.FileShare="UI_Sharing",t.ShowFileVersions="UI_FileVersions",t.UIWorkflow="UI_Workflow",t.IsDisabled="IsDisabled",t.AccessibilityLoopComplete="App_AccessibilityLoopComplete",t.Unloaded="Unloaded",t.Disposed="Disposed",t.SwitchMode="App_SwitchMode",t.DocumentReboot="DocReboot",t.WopiInfoFromUrl="WopiInfoFromUrl",t.DavUrlFromIds="DavUrlFromIds",t.ModeSwitched="ModeSwitched",t.CreateNewDocument="App_CreateNewDocument",t.GetAuthToken="GetAuthToken",t.GetCustomAuthConfig="GetCustomAuthConfig",t.SetOverlayContent="SetOverlayContent",t.MoveToFolder="MoveToFolder",t.SharedFilePicker="SharedFilePicker"}(i||(i={}))},function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return s})),n.d(e,"d",(function(){return c}));var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var r=function(){return(r=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function s(t,e,n,i){return new(n||(n=Promise))((function(o,r){function s(t){try{a(i.next(t))}catch(t){r(t)}}function c(t){try{a(i.throw(t))}catch(t){r(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,c)}a((i=i.apply(t,e||[])).next())}))}function c(t,e){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(r){return function(c){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,c])}}}Object.create;Object.create},function(t,e,n){"use strict";n.d(e,"h",(function(){return o})),n.d(e,"e",(function(){return r})),n.d(e,"f",(function(){return s})),n.d(e,"g",(function(){return a})),n.d(e,"i",(function(){return u})),n.d(e,"j",(function(){return f})),n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return l})),n.d(e,"c",(function(){return p})),n.d(e,"d",(function(){return v}));var i=n(7),o="word-edit",r="/we/",s="wordeditorframe.aspx",c=r+s,a="wordeditorstartsession.ashx",u="/wv/",f="wordviewerframe.aspx",d=u+f;function h(t){return t.toLowerCase().indexOf(s)>0}function l(t){return t.toLowerCase().indexOf(f)>0}function p(t,e){void 0===e&&(e=!1);var n=t;return n=(n=n.replace(new RegExp(o,"i"),"word-view")).replace(new RegExp(c,"i"),d),e&&(n=Object(i.b)(n,"WordEditorFailedToLoad","1")),n}function v(t){var e=t;return e=(e=e.replace(new RegExp("word-view","i"),o)).replace(new RegExp(d,"i"),c)}},function(t,e,n){"use strict";var i=n(24);n.d(e,"d",(function(){return i.a}));var o=n(18);n.d(e,"a",(function(){return o.a}));var r=n(22);n.d(e,"b",(function(){return r.a}));var s=n(26);n.d(e,"c",(function(){return s.a}))},,function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"t",(function(){return r})),n.d(e,"s",(function(){return s})),n.d(e,"n",(function(){return c})),n.d(e,"o",(function(){return a})),n.d(e,"m",(function(){return u})),n.d(e,"u",(function(){return f})),n.d(e,"i",(function(){return d})),n.d(e,"h",(function(){return h})),n.d(e,"f",(function(){return l})),n.d(e,"e",(function(){return p})),n.d(e,"a",(function(){return v})),n.d(e,"q",(function(){return m})),n.d(e,"d",(function(){return b})),n.d(e,"k",(function(){return O})),n.d(e,"b",(function(){return w})),n.d(e,"r",(function(){return g})),n.d(e,"w",(function(){return j})),n.d(e,"j",(function(){return S})),n.d(e,"v",(function(){return I})),n.d(e,"p",(function(){return y})),n.d(e,"l",(function(){return T})),n.d(e,"g",(function(){return _}));var i=["eurppc"],o="AppSettingsHandler.ashx",r="RemoteUls.ashx",s="RemoteTelemetry.ashx";function c(t){return 8===t.toLowerCase().indexOf("ffc")}function a(t){return 8===t.toLowerCase().indexOf("ppc")}function u(t){var e=t.match(/^https:\/\/((?!word)\w+)(-\w+)+\..*$/i);return e&&e[1]?e[1]:"public"}function f(t,e){if(!e||-1===i.indexOf(e.toLowerCase()))return t;var n=t.match(/(^http[s]:\/\/)((?!word)\w*[-])?(.*)/i);return n?"".concat(n[1]).concat(e,"-").concat(n[3]):t}function d(t){var e=t.match(/^(.*?\/\/[^\/]+)(.*)$/);if(!e)throw new Error("Invalid URL");return e[1]}function h(t,e){var n=t.match(/^(.*?\/\/)([^\/:]+)(.*)$/);if(!n)throw new Error("Invalid URL");var i=n[2];if(void 0===e)return i;if(e<0)throw new Error("subDomainParts should be at least 1");return i.split(".").slice(-(e+1)).join(".")}function l(t){return t+r}function p(t){return t+s}function v(t,e,n){n&&(t[e.toLowerCase()]=n)}function m(t,e){t[e.toLowerCase()]=""}function b(t,e,n){var i=[];for(var o in n)n[o]&&i.push(o+"="+n[o]);return t+e+(i.length>0?"?"+i.join("&"):"")}function O(t,e){var n=t.toLowerCase(),i=e.toLowerCase(),o=n.indexOf("&"+i+"=");if(-1===o&&(o=n.indexOf("?"+i+"=")),-1===o)return"";var r=o+(e.length+2),s=t.indexOf("&",r);return t.substring(r,-1===s?void 0:s)}function w(t,e,n,i){if(!n)return t;var o=t,r=o.indexOf("?"),s="&";r===o.length-1||"&"===o.slice(-1)||"&>"===o.slice(-2)?s="":-1===r&&(s="?");var c=e.toLowerCase()+"=",a=o.toLowerCase().indexOf(c,r);if("?"!==s&&a>=0){if(i){var u=o.indexOf("&",a);o=o.substring(0,a)+c+n+(-1===u?"":o.substring(u))}return o}return o.concat(s,c,n)}function g(t){var e={},n=t.indexOf("?");return-1===n||n===t.length-1||t.substring(n+1).replace(new RegExp(/<.*?>/g),"").split("&").forEach((function(t){if(t){var n=t.indexOf("=");-1!==n&&n!==t.length-1&&(e[t.substring(0,n).toLowerCase()]=t.substring(n+1))}})),e}function j(t,e){if(!t)return t;var n=t,i=n.indexOf("?"),o=e.toLowerCase()+"=",r=n.toLowerCase().indexOf(o,i);if(r>=0){var s=n.indexOf("&",r);return"&"===(n=n.substring(0,r)+(-1===s?"":n.substring(s+1))).slice(-1)&&(n=n.slice(0,-1)),n}return t}function S(t){if(!t)return"";var e=-1===t.indexOf("#")?t.length:t.indexOf("#"),n=t.lastIndexOf("/",e);if(-1!==n&&n+1===t.indexOf("://")+"://".length)return"";n+=1;var i=t.indexOf("?");if(-1!==(i=i>=e?-1:i)&&n>i)return"";var o=-1===i?e:i;return n>=o?"":t.substring(n,o)}function I(t){var e=new RegExp("(c[1-5])h?(-)");return t.replace(e,"$1h$2")}function y(t,e,n){var i=new RegExp("[?&]"+e+"=("+(n||"1")+")\\b","i"),o=t.match(i);return!!o&&(!n||o[1]===n)}function T(t,e){var n=O(t,e);return n?decodeURI(n):n}function _(t){return t?t.indexOf("://")>-1?t.split("/")[2]:t.split("/")[0]:""}},function(t,e,n){"use strict";function i(t){if(t){var e=t.lastIndexOf(".");if(-1!==e)return t.substring(e+1).toLowerCase()}return""}function o(t){return JSON.stringify(t,Object.getOwnPropertyNames(t))}n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}))},function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),function(t){t.gt="App_AccessibilityLoopComplete",t.jt="Wac_ActionComplete",t.St="WacInitialize_Ready",t.It="Wac_AppFailed",t.yt="Wac_AppBootState",t.Tt="Wac_AppCompleted",t._t="BrowserEvent",t.Ct="UI_Close",t.Pt="App_CloseTab",t.Rt="UI_Conversation",t.At="UI_CopyAndEdit",t.Ut="App_CreateNewDocument",t.Et="Wac_AppDataSavedStatus",t.Wt="UI_Download",t.Ft="UI_Edit",t.Nt="Error",t.xt="UI_FileEmbed",t.Mt="UI_FileProperties",t.kt="File_Rename",t.Dt="File_RenameFailed",t.Ht="UI_FileVersions",t.Jt="StateChanged",t.Bt="App_IsFrameTrusted",t.Vt="GetAccessToken",t.zt="App_GetAuthToken",t.Lt="App_GetCustomAuthConfig",t.qt="App_GetHostKeyValue",t.Gt="App_WopiInfoFromUrl",t.Kt="App_DavUrlFromIds",t.Zt="App_LoadingStatus",t.$t="App_SwitchMode",t.Xt="App_MoveToFolder",t.Qt="UI_OpenInMobileApp",t.Yt="UI_OpenInBrowser",t.te="UI_OpenInClient",t.ee="PageChanged",t.ne="App_PushCommentContext",t.ie="App_PushState",t.oe="App_DocReboot",t.re="UI_RedeemForCommenting",t.se="App_RefreshSessionInfo",t.ce="UI_ReplyWithChanges",t.ae="UI_ReportAbuse",t.ue="App_FilePicker",t.fe="UI_SaveStatus",t.de="WopiSession_Complete_Ack",t.he="SetOverlayContent",t.le="UI_Sharing",t.pe="UI_ShareForm",t.ve="UI_SignIn",t.me="App_StoreHostKeyValue",t.be="App_Unloaded",t.Oe="Wac_UnloadingApp",t.we="App_UpdateBootComplete",t.ge="PageCount",t.je="UI_CheckUserAccessAndGrantPermissions",t.Se="User_Activity",t.Ie="Edit_Notification",t.ye="UI_Workflow",t.Te="ZoomChanged",t._e="Excel_HostFrameCacheSave",t.Ce="Excel_HostFrameCacheEvict",t.Pe="Excel_RegenerateFileBundle",t.Re="App_SwitchToWacFrame",t.Ae="App_SaveSSRData",t.Ue="App_PurgeDataInHostCache",t.Ee="App_SaveHostRenderingV2Data",t.We="App_SaveHostUtilsData"}(i||(i={}))},,function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return s}));var i,o=function(){try{var t=window.performance;return t&&t.now&&t.now()!==1/0}catch(t){return!1}}();function r(){return o?window.performance.now():Date.now()}function s(){if(!i){var t=window.performance;i=o&&t.timing&&t.timing.navigationStart?function(){return Math.round(t.now()+t.timing.navigationStart)}:Date.now?Date.now:function(){return(new Date).getTime()}}return i()}},,function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),function(t){t.AppInitError="AppInitError",t.ApiDisabledError="ApiDisabledError",t.CannotLoadFirstPage="CannotLoadFirstPage",t.InvalidWopiInfo="InvalidWopiInfo",t.TimeoutWacReady="TimeoutWacReady",t.WacFailed="WacFailed"}(i||(i={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"d",(function(){return d})),n.d(e,"c",(function(){return h})),n.d(e,"b",(function(){return l}));var i=n(7),o=n(50),r=n(51),s=n(19),c=n(52),a=n(53),u="Word";function f(t){return t+i.s}function d(t){return f(l(t))}function h(t,e,n,d,h,p){void 0===p&&(p=!1),t.SessionInformation.IsCore&&(t.SessionInformation.HideViewerToolbar=!0),function(t,e){var n=t.SessionInformation;n.WdParams||(n.WdParams={});if(n.WdParams.wd)return;e.substring(1).split("&").filter((function(t){if(0===t.indexOf("wd")){var e=t.split("=");e[0].length>2&&(n.WdParams[e[0]]=e[1])}}));var i=t.RebootOverrideData;i&&i.previousSessionId&&(n.WdParams.wdprevioussession=i.previousSessionId)}(t,window.location.search);var v=h||new o.a(u,n),m=l(t.ApplicationUrl),b={container:t.Container,sessionInformation:t.SessionInformation,applicationUrl:t.ApplicationUrl,wopiPrecheckInfo:t.WopiPrecheckInfo,applicationCustomSettings:t.ApplicationCustomSettings,diagnostics:{HostInitDiagnostics:t.Diagnostics,ClientDiagnostics:Object(r.b)(),AppInitDiagnostics:{officeSessionId:e,officeBootstrapperVersion:Object(s.a)(),hostName:t.SessionInformation.HostName},SessionTraces:{}},fnOnInitializeSuccess:t.FnOnInitializeSuccess,fnOnInitializeFailure:t.FnOnInitializeFailure,sessionId:e,applicationBasePath:m,remoteTelemetryUrl:f(m),wopiInfo:t.WopiInfo,forceSingleStepBoot:p,isCreateNew:t.WopiPrecheckInfo.IsNewFile||Object(i.p)(t.ApplicationUrl,"new"),featureManager:d||Object(c.a)(t.FnIsFeatureEnabled,n),Fe:v,newFileTemplateSource:t.NewFileTemplateSource,rebootOverrideData:t.RebootOverrideData,pageStateObserver:new a.a(n,!0),canSupportConsumption:!1};return b}function l(t){var e=t.match(/^(.*?\/\/[^\/]+\/[^\/]+\/)(.*)$/);if(!e)throw new Error("Invalid URL");return e[1]}},function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return s})),n.d(e,"b",(function(){return c})),n.d(e,"g",(function(){return a})),n.d(e,"d",(function(){return u})),n.d(e,"f",(function(){return f})),n.d(e,"e",(function(){return d})),n.d(e,"h",(function(){return h})),n.d(e,"i",(function(){return p})),function(t){t[t.Firefox=0]="Firefox",t[t.Opera=1]="Opera",t[t.IE=2]="IE",t[t.Edge=3]="Edge",t[t.Chrome=4]="Chrome",t[t.Safari=5]="Safari",t[t.TeamsElectron=6]="TeamsElectron",t[t.Unknown=7]="Unknown"}(i||(i={}));var o=window.navigator,r=o?o.userAgent:void 0;function s(){if(r){if(r.indexOf("Firefox")>-1)return i.Firefox;if(r.indexOf("Opera")>-1||r.indexOf("OPR")>-1)return i.Opera;if(r.indexOf("Trident")>-1)return i.IE;if(r.indexOf("Electron")>-1&&r.indexOf("Teams")>-1)return i.TeamsElectron;if(r.indexOf("Edg")>-1)return i.Edge;if(r.indexOf("Chrome")>-1)return i.Chrome;if(r.indexOf("Safari")>-1)return i.Safari}return i.Unknown}function c(){"undefined"!=typeof PerformanceResourceTiming&&void 0===PerformanceResourceTiming.prototype.toJSON&&(PerformanceResourceTiming.prototype.toJSON=function(){return{name:this.name,connectStart:this.connectStart,connectEnd:this.connectEnd}})}function a(){try{return!!r&&r.indexOf("iPad")>=0||!!r&&r.indexOf("Macintosh")>=0&&v()&&!l()||!!r&&r.indexOf("Android")>=0||v()}catch(t){return!1}}function u(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch(t){return!1}}function f(){return s()===i.IE&&!function(){if(s()!==i.IE)return!1;if(null==document.documentMode||void 0===document.documentMode)return!1;return document.documentMode>=11}()}function d(){return s()===i.IE}function h(){try{return window.external&&window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'===window.external.getHostEnvironmentValue("os-sku")}catch(t){return!1}}function l(){return!!r&&r.indexOf("iPhone")>=0}function p(){try{return window.matchMedia("(prefers-color-scheme: dark)").matches}catch(t){return!1}}function v(){return!!o&&o.maxTouchPoints>0}},function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),function(t){t.Ne="BootstrapperMaxUlsHeartbeatTime",t.xe="BootstrapperNoCompleteWarning1Time",t.Me="BootstrapperNoCompleteWarning2Time",t.ke="RemoteUlsETag",t.De="RemoteUlsSuppressions",t.He="BootstrapperSettingsFetchPeriod",t.Je="timestamp",t.Be="BootstrapperUlsHeartbeatIntervalMs",t.Ve="BootstrapperUlsHeartBeatIsEnabled",t.ze="BootstrapperUlsUploadCadenceMs",t.Le="WordConsumptionViewToEditRedirectIsEnabled",t.qe="RequestedCallThrottlingDefaultToViewMinimumValue"}(i||(i={}))},function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),function(t){t.Ge="Ack",t.Ke="WacInitialize_Ready_Ack",t.Ze="Wac_BeforeUnloadApp",t.$e="Blur_Focus",t.Xe="Wac_AppFailed_Ack",t.Qe="Wac_AppCompleted_Ack",t.Ye="WopiStartSession_Complete",t.tn="WopiPendingSession_Complete",t.en="Host_AccessibilityLoopComplete",t.Bt="Host_IsFrameTrusted",t.nn="Grab_Focus",t.in="HostCacheDiagnostic",t.on="Host_KeyValue",t.rn="JsApiDiagnostics",t.Xt="Host_MoveToFolder",t.sn="PageChanged_Ack",t.cn="App_PopState",t.an="File_Rename",t.ue="Host_FilePicker",t.un="PostAccessToken",t.fn="Host_SetAuthToken",t.dn="Host_SetCustomAuthConfig",t.hn="App_PushCommentContext",t.ln="CanEmbed",t.pn="Host_RefreshSessionInfo",t.vn="CheckUserAccessAndGrantPermissions_Result",t.mn="Host_WopiInfoFromUrl",t.bn="Host_DavUrlFromIds",t.On="SetCurrentPage",t.wn="SetZoomLevel",t.gn="WopiPendingSession_Fail",t.jn="SetOverlayContent",t.Sn="WopiPendingApplicationComplete_Received",t.In="Host_SwitchMode",t.yn="Host_Unload",t.Tn="PageCount_Ack",t._n="ZoomChanged_Ack",t.Cn="Host_ShareUI",t.Pn="Host_Telemetry"}(i||(i={}))},function(t,e,n){"use strict";var i=n(37);n.d(e,"a",(function(){return i.a}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i= "16.0.15205.41011";function o(){return i}},function(t,e,n){"use strict";n.d(e,"b",(function(){return d})),n.d(e,"a",(function(){return h}));var i=n(0),o=n(1),r=n(11),s=n(9),c=n(17),a=n(8),u=!1,f=!1;function d(){u=!1}function h(t,e,n,a,d,h,p){if(e.ULS.Rn(595714433,i.a.Z,o.a.Info,"Starting disposing the application. unloadApp:".concat(t,"; disposed:").concat(u,"; unloading:").concat(f)),u||f&&t)e.ULS.Rn(595714908,i.a.Z,o.a.Info,"Application is already disposed or unloading");else{var v,m={logger:e,postMessenger:n,innerApplicationFrame:a,onDisposed:d,onFrameRemoved:h,unloadTimeoutInMs:p||1e3,forceAppUnload:!1,disposeStartTime:Object(r.a)(),appUnloadTimedOut:!1};if(t&&a)return f=!0,m.forceAppUnload=!0,(v=m).forceAppUnloadStartTime=Object(r.a)(),v.logger.ULS.Rn(595855490,i.a.Z,o.a.Info,"Sending postmessage to unload app"),v.logger.ULS.flush(),v.postMessenger.registerMessagePayloadHandler(s.a.be,(function(t){return function(t,e){t.forceAppUnloadEndTime=Object(r.a)(),t.appUnloadedMessageValues=e,t.logger.ULS.Rn(595855491,i.a.Z,o.a.Info,"AppUnloaded received from app"),l(t)}(v,t)})),v.postMessenger.sendPostMessage(v.innerApplicationFrame,c.a.yn,{}),void window.setTimeout((function(){return function(t){!f&&u||(t.appUnloadTimedOut=!0,t.logger.ULS.Rn(595855492,i.a.Z,o.a.Info,"ApplicationUnload timed out, forcing dispose"),l(t))}(v)}),v.unloadTimeoutInMs);l(m)}}function l(t){if(!u)try{u=!0,f=!1,function(t){if(!t.innerApplicationFrame)return;t.innerApplicationFrame.src="about:blank",window.setTimeout((function(){t.innerApplicationFrame&&t.innerApplicationFrame.parentElement&&t.innerApplicationFrame.parentElement.removeChild(t.innerApplicationFrame),t.onFrameRemoved&&t.onFrameRemoved()}),0)}(t),function(t){var e={disposeStartTime:t.disposeStartTime,disposeEndTime:Object(r.a)(),forceAppUnload:t.forceAppUnload,appUnloadTimedOut:t.appUnloadTimedOut};t.forceAppUnloadStartTime&&(e.appUnloadStartTime=t.forceAppUnloadStartTime);t.forceAppUnloadEndTime&&(e.appUnloadEndTime=t.forceAppUnloadEndTime);if(t.appUnloadedMessageValues){var n=t.appUnloadedMessageValues,s=Number(n.hostMessageReceived);t.forceAppUnloadStartTime&&!isNaN(s)&&(e.hostToAppPostMessageLatency=s-t.forceAppUnloadStartTime);var c=Number(n.appMessageSent);!isNaN(c)&&t.forceAppUnloadEndTime&&(e.appToHostPostMessageLatency=t.forceAppUnloadEndTime-c);var a=Number(n.appUnloadStart),u=Number(n.appUnloadEnd);if(isNaN(a)||isNaN(u)||(e.appUnloadLatency=u-a),n.serverTimings){var f=n.serverTimings;for(var d in f)e["st-"+d.toString()]=f[d]}}t.logger.ULS.Rn(595855436,i.a.Z,o.a.Info,"App disposed "+JSON.stringify(e)),t.logger.ULS.flushOnClose()}(t),t.onDisposed&&t.onDisposed()}catch(e){t.logger.ULS.Rn(595714434,i.a.Z,o.a.Error,"Error disposing: ".concat(Object(a.b)(e)))}}},function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),function(t){t.An="EnterpriseTemplates",t.Un="ExcelAdaptiveLayoutDownload",t.En="ExcelLandingPageOfflineTelemetry",t.Wn="ExcelLandingPageObserverRetry",t.Fn="H2StaticContent",t.Nn="HashedUrl",t.xn="ODCShareLinkPreload",t.Mn="OfficeComExcelJsApiV2",t.kn="OfficeComPptJsApiV2",t.Dn="OfficeComUiHost",t.Hn="OfficeComWordJsApiV2",t.Jn="OfficeHwaUiHost",t.Bn="OfficeUnifiedUiHostTeams",t.Vn="WordViewToUnifiedRead",t.zn="PreConnectToWacIframeLink"}(i||(i={}))},function(t,e,n){"use strict";var i;!function(t){t[t.NotSupported=0]="NotSupported",t[t.SameDocOnly=1]="SameDocOnly",t[t.AnyDoc=2]="AnyDoc",t[t.OtherMode=4]="OtherMode"}(i||(i={})),n.d(e,"a",(function(){return i}))},,function(t,e,n){"use strict";var i=n(42);n.d(e,"a",(function(){return i.b}))},,function(t,e,n){"use strict";var i=n(43);n.d(e,"a",(function(){return i.a}))},function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return s})),n.d(e,"d",(function(){return c}));var i,o=365;function r(t,e){var n=s(t);return"true"===n||"false"!==n&&e}function s(t){if(!t)return"";var e=""+document.cookie,n=new RegExp("(?:^|; )"+t+"=([^;]*)"),i=e.match(n);return!i||i.length<2?"":i[1]}function c(t,e,n,r){void 0===r&&(r=i.none);var s=t+"="+e,a="",u=new Date;u.setTime(u.getTime()+864e5*o);var f=new Date;f.setTime(f.getTime()+864e5*n),f>u&&(f=u),f&&(a=";expires="+f.toUTCString());var d=";SameSite="+i[r];return document.cookie=s+a+d,!(!document.cookie||-1===document.cookie.indexOf(s))||r===i.none&&c(t,e,n,i.doNotSet)}!function(t){t[t.doNotSet=0]="doNotSet",t[t.none=1]="none",t[t.lax=2]="lax",t[t.strict=3]="strict"}(i||(i={}))},function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),function(t){t.Ln="ClassicViewModePreference"}(i||(i={}))},,,,function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),function(t){t.Unknown="UNKNOWN",t.Initialized="INITIALIZED",t.Prebooted="PREBOOTED",t.Booting="BOOTING",t.Booted="BOOTED",t.Failed="FAILED",t.Disposing="DISPOSING",t.Disposed="DISPOSED"}(i||(i={}))},,,function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return p}));var i=n(9),o=n(0),r=n(1),s=n(8),c=n(17),a=n(54),u=n(19),f=n(2),d=n(20),h=n(14),l=function(){function t(t,e,n,u,h){var l=this;this.qn={},this.Gn=function(){l.Kn.registerMessagePayloadHandler(i.a.oe,l.Zn),l.Kn.registerMessagePayloadHandler(i.a.Gt,l.$n),l.Kn.registerMessagePayloadHandler(i.a.Kt,l.Xn),l.Kn.registerMessagePayloadHandler(i.a.zt,l.Qn),l.Kn.registerMessagePayloadHandler(i.a.le,l.Yn),l.Kn.registerMessagePayloadHandler(i.a.Lt,l.ti),l.Kn.registerMessagePayloadHandler(i.a.Xt,l.ei),l.Kn.registerMessagePayloadHandler(i.a.ue,l.ni)},this.ii=function(t,e){var n=l.qn[t];if(n)try{n(e||{})}catch(t){l.oi.ULS.Rn(593773706,o.a.Z,r.a.Error,"Handler error: ".concat(Object(s.b)(t)))}},this.Zn=function(t){t.previousSessionId=l.ri,l.ii(f.a.DocumentReboot,t)},this.$n=function(t){l.ii(f.a.WopiInfoFromUrl,t)},this.Xn=function(t){l.ii(f.a.DavUrlFromIds,t)},this.Qn=function(t){Promise?l.si.isResourceTrustedForMessage(t).then((function(e){e?l.ii(f.a.GetAuthToken,t):l.Kn.sendPostMessage(l.ci,c.a.fn,{AuthToken:"",Error:"accessDenied",RequestId:t.RequestId,IdentityType:t.IdentityType})}),(function(){l.Kn.sendPostMessage(l.ci,c.a.fn,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:t.RequestId,IdentityType:t.IdentityType})})):l.Kn.sendPostMessage(l.ci,c.a.fn,{AuthToken:"",Error:'"Promise" does not exist natively in browser',RequestId:t.RequestId,IdentityType:t.IdentityType})},this.Yn=function(t){l.ii(f.a.FileShare,t)},this.ti=function(t){l.ii(f.a.GetCustomAuthConfig,t)},this.ei=function(t){l.ii(f.a.MoveToFolder,t)},this.ni=function(t){l.ii(f.a.SharedFilePicker,t)},this.ri=t,this.oi=e,this.ci=h.innerApplicationFrame,this.Kn=n,this.ai=u,this.si=new a.a(e),this.Gn(),Object(d.b)()}return t.prototype.GetApplicationType=function(){return h.a},t.prototype.GetVersion=function(){return Object(u.a)()},t.prototype.GetSessionId=function(){return this.ri},t.prototype.RegisterEventHandler=function(t,e){switch(t){case f.a.Unloaded:case f.a.Disposed:case f.a.DocumentReboot:case f.a.WopiInfoFromUrl:case f.a.DavUrlFromIds:case f.a.GetAuthToken:case f.a.GetCustomAuthConfig:case f.a.MoveToFolder:case f.a.SharedFilePicker:case f.a.SetOverlayContent:case f.a.FileShare:if(this.qn[t])throw new Error("Duplicate registration");this.qn[t]=e;break;default:this.Kn.registerMessagePayloadHandler(t,e)}},t.prototype.RemoveEventHandler=function(t,e){switch(t){case f.a.Unloaded:case f.a.Disposed:case f.a.DocumentReboot:case f.a.FileShare:case f.a.WopiInfoFromUrl:case f.a.DavUrlFromIds:case f.a.GetAuthToken:case f.a.GetCustomAuthConfig:case f.a.MoveToFolder:case f.a.SharedFilePicker:case f.a.SetOverlayContent:if(this.qn[t]!==e)throw new Error("The handler requested to be removed does not exist for the eventType");delete this.qn[t];break;default:this.Kn.removeMessageHandler(t)}},t.prototype.RegisterErrorHandler=function(t){},t.prototype.RemoveErrorHandler=function(t){},t.prototype.PostCommand=function(t,e){this.Kn.postMessageForCommand(this.ci,t,e)},t.prototype.Dispose=function(t,e){var n=this;Object(d.a)(t||!1,this.oi,this.Kn,this.ci,(function(){delete n.ci,n.ai(),n.Kn.dispose(),n.ii(f.a.Unloaded,{})}),(function(){try{n.ii(f.a.Disposed,{}),n.qn={}}catch(t){n.oi.ULS.Rn(589108815,o.a.Z,r.a.Error,"onFrameRemoved error: ".concat(Object(s.b)(t)))}}),e)},t}();function p(t,e,n,i,o){return new l(t,e,n,i,o)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(7);function o(t){var e=document.createElement("link");e.rel="preconnect",e.href=t,e.crossOrigin="anonymous",document.head.appendChild(e)}function r(t,e){return void 0===t&&(t=!1),{shouldPreconnect:function(t){return s&&(!e||e(t))},preconnect:function(e){return o(t?Object(i.v)(e):e)}}}var s=!0},function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),function(t){t.blurFocus="blurFocus",t.boot="boot",t.completeCreateNew="completeCreateNew",t.continueAccessibilityLoop="continueAccessibilityLoop",t.createNew="createNew",t.dispose="dispose",t.grabFocus="grabFocus",t.moveToFolder="moveToFolder",t.popState="popState",t.rename="rename",t.completeSharedFilePicker="completeSharedFilePicker",t.sendAccessToken="sendAccessToken",t.sendAuthToken="sendAuthToken",t.sendCustomAuthConfig="sendCustomAuthConfig",t.sendEmbeddedViewUrl="sendEmbeddedViewUrl",t.sendSessionInfo="sendSessionInfo",t.sendUserAccessAndPermissions="sendUserAccessAndPermissions",t.sendWopiInfo="sendWopiInfo",t.sendDavUrl="sendDavUrl",t.switchMode="switchMode",t.signalShared="signalShared"}(i||(i={}))},function(t,e,n){"use strict";var i=n(3),o=n(0),r=n(1),s=n(7),c=n(19),a=n(87),u=n(11),f=n(88),d=n(95),h=n(15),l=n(9),p=n(21),v=n(8),m=n(51),b=n(17),O=n(94),w=n(13);function g(t,e){e&&e.Diagnostics&&Object.keys(e.Diagnostics).forEach((function(n){return t[n]=e.Diagnostics[n]}))}function j(t,e,n){e.ULS.Rn(596459999,o.a.Z,n,"SessionTraces: "+JSON.stringify(t))}function S(t,e){e.stop();var n=e.getVisibilityChangeEvents();null!=n&&n.length>0&&(t.AppInitDiagnostics.documentLoadedWithTabSwitch=!0,t.SessionTraces.tabSwitchDiagnostics=JSON.stringify(n)),e.dispose()}function I(t,e,n){try{var a=function(t,e){var n=Object(i.a)({},e);delete n.UserId,delete n.OwnerId,delete n.SiteId,delete n.WebId,delete n.Upn,delete n.TenantId,delete n.UiHostTabId,delete n.WdParams;var o=n,r=e.WdParams?JSON.parse(JSON.stringify(e.WdParams).toLowerCase()):{};return o.WdParams={},["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf"].forEach((function(t){r[t]&&(o.WdParams[t]=r[t])})),o.UiEmbedMode=Object(s.p)(t,"uiembed"),o.UiHostName=Object(s.k)(t,"uih")||"N/A",o.HostDomain=location?location.hostname:"",o}(e.applicationUrl,e.sessionInformation);a.Build=Object(c.a)(),a.Region=Object(s.m)(e.applicationUrl);var u=Object(i.a)({},e.rebootOverrideData);delete u.ackExpected,delete u["ui-language"],delete u.wdUserSession,delete u.rebootMode,delete u.documentUrl,a.RebootOverride=u;var f=e.diagnostics.HostInitDiagnostics;f&&(t.ULS.Rn(596444238,o.a.Z,r.a.Info,"HostInitDiagnostics: "+JSON.stringify(e.diagnostics.HostInitDiagnostics)),a.SessionOrigin=f.entryPoint),n&&t.ULS.Rn(595937313,o.a.Z,r.a.Info,JSON.stringify(n));var d=e.wopiInfo;d&&d.AccessToken&&d.AccessTokenExpiry||t.ULS.Rn(595894553,o.a.Z,r.a.Warning,"There are some missing parameters"),d&&(d.AccessToken&&(a.AccessTokenLength=d.AccessToken.length),a.AccessTokenExpiry=d.AccessTokenExpiry),a.JsApiVersion="v1",t.ULS.Rn(596444237,o.a.Z,r.a.Info,JSON.stringify({session:a,client:e.diagnostics.ClientDiagnostics}))}catch(e){t.ULS.Rn(558155802,o.a.Z,r.a.Error,"Failed to log initialization info: ".concat(Object(v.b)(e)))}}var y,T=n(14),_=n(90),C=n(89),P=n(91),R=n(92),A=n(93),U=n(52),E=n(16),W=n(27),F=n(4),N=n(28);function x(t,e){var n={isSingleStepBoot:t.forceSingleStepBoot,bootFlowType:t.forceSingleStepBoot?y.forceSingleStepBoot:y.bootWithoutWopiInfo,ignoreWacFramePostMessages:!1};if(t.forceSingleStepBoot||(n=function(t,e){var n=t.applicationUrl,i=Object(F.a)(n),c=Object(F.b)(n),a=Object(s.p)(n,"uiembed"),u=Object(s.p)(n,"embed");return e.ULS.Rn(595640900,o.a.Z,r.a.Info,"gotUiEmbedUrl:".concat(a,", gotEditUrl:").concat(i,", gotViewUrl:").concat(c)),!i&&t.wopiPrecheckInfo.IrmEnabled?{isSingleStepBoot:!0,bootFlowType:a?y.wordUiEmbedIrmEnabledEarlyRedirect:y.unifiedIrmEnabled,ignoreWacFramePostMessages:!1}:(t.canSupportConsumption=t.Fe.getValue(E.a.Le,!1)&&t.featureManager.isFeatureEnabled(p.a.Vn)&&!a&&!u&&(t.isCreateNew&&!t.wopiInfo||"docx"===Object(v.a)(t.wopiPrecheckInfo.FileName))&&Object(m.d)(t.sessionInformation.HostName)&&!(t.sessionInformation.WdParams&&"1"===t.sessionInformation.WdParams.wdEmbedFS),t.canSupportConsumption&&c&&!Object(W.a)(N.a.Ln,!1)&&!Object(m.e)(t.wopiPrecheckInfo.RequestedCallThrottling,t.Fe.getValue(E.a.qe,"Major"))?{isSingleStepBoot:!0,bootFlowType:y.wordViewToUnifiedReadRedirect,ignoreWacFramePostMessages:!1}:i?(e.ULS.Rn(575980770,o.a.Z,r.a.Info,"readOnly:".concat(t.wopiPrecheckInfo.ReadOnly)),t.wopiPrecheckInfo.ReadOnly&&a?{isSingleStepBoot:!0,bootFlowType:y.wordUiEmbedReadOnlyEarlyRedirect,ignoreWacFramePostMessages:!1}:t.wopiInfo||Object(h.e)()?{isSingleStepBoot:!0,bootFlowType:y.unifiedSingleFlush,ignoreWacFramePostMessages:t.isCreateNew||!1}:{isSingleStepBoot:!1,bootFlowType:y.bootWithoutWopiInfo,ignoreWacFramePostMessages:!1}):{isSingleStepBoot:!0,bootFlowType:c?y.unifiedViewActionUrl:y.unifiedNotEditOrViewActionUrl,ignoreWacFramePostMessages:!c})}(t,e)),n.isSingleStepBoot){var i={singleStepBootIsRequired:!0,singleStepBootReason:n.bootFlowType,irmEnabled:t.wopiPrecheckInfo.IrmEnabled,readOnly:t.wopiPrecheckInfo.ReadOnly,ignoreWacFramePostMessages:n.ignoreWacFramePostMessages};e.ULS.Rn(596444182,o.a.Z,i.irmEnabled?r.a.Warning:r.a.Info,JSON.stringify(i))}else e.ULS.Rn(596444183,o.a.Z,r.a.Info,"Received input valid for two step flow");return n}!function(t){t.bootWithoutWopiInfo="",t.unifiedSingleFlush="Unified_SingleFlush",t.unifiedIrmEnabled="Unified_IrmEnabled",t.unifiedViewActionUrl="Unified_ViewActionUrl",t.unifiedNotEditOrViewActionUrl="Unified_NotEditOrViewActionUrl",t.forceSingleStepBoot="Force_SingleStepBoot",t.wordUiEmbedReadOnlyEarlyRedirect="WordUiEmbed_ReadOnlyEarlyRedirect",t.wordUiEmbedIrmEnabledEarlyRedirect="WordUiEmbed_IrmEnabledEarlyRedirect",t.wordViewToUnifiedReadRedirect="WordView_UnifiedReadRedirect"}(y||(y={}));function M(t,e,n,i,o,r,c){return function(t,e,n,i){Object(C.b)(t,i);var o=e.ownerDocument,r=o.createElement("form");for(var s in r.id="office_form",r.name="office_form",r.action=n,r.target=t.name,r.method="POST",i){var c=o.createElement("input");c.type="hidden",c.name=s,c.value=i[s],r.appendChild(c)}return e.appendChild(r),r.submit(),t}(function(t,e,n){var i=t.ownerDocument.createElement("iframe");i.name=n||"WebApplicationFrame",i.id="WebApplicationFrame",i.src="",i.title="Office Online Frame",i.width="100%",i.height="100%",i.marginWidth="0",i.marginHeight="0",i.style.left="0",i.style.top="0",i.style.right="0",i.style.bottom="0",i.style.display="block",i.style.position="absolute",i.style.backgroundColor="transparent",i.style.border="none",i.frameBorder="0",i.setAttribute("allowfullscreen","true"),i.setAttribute("allowTransparency","true");var o=Object(s.i)(e);return i.setAttribute("allow","microphone ".concat(o,"; autoplay ").concat(o,"; camera ").concat(o,"; clipboard-read ").concat(o,"; clipboard-write ").concat(o,"; keyboard-map ").concat(o,";")),t.appendChild(i),i}(t,e,c),t,e,n)}function k(t,e,n){void 0===n&&(n=!1);var o=t.applicationUrl;var r={jsApi:"1",jsapiver:"v1"};if(n&&(r.NewSession="1"),r.corrid=t.sessionId,r.usid=t.sessionId,r.sftc="1",t.applicationCustomSettings&&t.applicationCustomSettings.IsCore&&(r.core="1"),t.sessionInformation.HideViewerToolbar&&(r.hvt="1"),t.sessionInformation.DisableFocusOnBoot&&(r.disableFocusOnBoot="1"),t.sessionInformation.HighContrastMode&&(r.hcm=encodeURIComponent(t.sessionInformation.HighContrastMode)),t.sessionInformation.SupportsAtMentions&&(r.sams="1"),t.sessionInformation.SupportsAccessibilityLoop&&(r.accloop="1"),t.sessionInformation.SupportsDocReboot){var c=t.sessionInformation.SupportsDocReboot;r.sdr=!0===c?"1":c.toString()}return t.sessionInformation.SupportsCreateNewDocument&&(r.scnd="1"),t.sessionInformation.SupportsAuthToken&&(r.sat="1"),t.sessionInformation.SupportsCustomAuthConfig&&(r.cac="1"),t.sessionInformation.SupportsMoveToFolder&&(r.mtf="1"),t.sessionInformation.SupportsCommonFilePicker&&(r.sfp="1"),t.sessionInformation.OpenLinksInNewWindow&&(r.onw="1"),t.sessionInformation.UseDarkTheme&&(r.udt="1"),t.sessionInformation.HideHeader&&(r.hhdr="1"),t.sessionInformation.HideAppLauncherInHeader&&(r.halh="1"),t.sessionInformation.HideChatInHeader&&(r.hch="1"),t.sessionInformation.HideMeInHeader&&(r.hmh="1"),t.sessionInformation.HideSearchInHeader&&(r.hsh="1"),t.sessionInformation.HideWorkflowInHeader&&(r.hwfh="1"),t.sessionInformation.HideSettingsInHeader&&(r.hsth="1"),t.sessionInformation.ShowAppIconInHeader&&(r.sih="1"),t.sessionInformation.UseNeutralColorInHeader&&(r.unh="1"),t.sessionInformation.HideBreadCrumbInViewer&&(r.hbcv="1"),t.sessionInformation.HideTitleInViewer&&(r.htv="1"),t.sessionInformation.HideWACOneDriveFileLocationPicker&&(r.hodflp="1"),t.sessionInformation.NoBrowserModalDialogs&&(r.nbmd="1"),t.applicationCustomSettings&&t.applicationCustomSettings.FixDiagnosticsJson&&(r.fixdiag="1"),(t.wopiPrecheckInfo.ReadOnly||e.bootFlowType===y.wordViewToUnifiedReadRedirect)&&(r.readOnly="1"),"DocGen"===t.sessionInformation.ContentAssemblyMode&&(r.readOnly="1"),e.bootFlowType===y.wordViewToUnifiedReadRedirect&&(r.cons="1"),t.canSupportConsumption&&(r.csc="1"),t.sessionInformation.UIEmbed&&(r.uiEmbed="1"),t.sessionInformation.UiHostIntegrationType&&(r.uihit=encodeURIComponent(t.sessionInformation.UiHostIntegrationType)),t.sessionInformation.MetaUiHostVersion&&(r.muv=encodeURIComponent(t.sessionInformation.MetaUiHostVersion)),t.applicationCustomSettings&&t.applicationCustomSettings.InAppDocumentPreview&&(r.InAppDocPreview="1"),e.isSingleStepBoot?(e.bootFlowType===y.unifiedSingleFlush&&(t.isCreateNew||(r.instantedit="1",r.wopicomplete="1")),r.wdRedirectionReason=e.bootFlowType):(r.instantedit="1",r.fileSrc=encodeURIComponent(t.sessionInformation.HostName),r.pmOrigin=encodeURIComponent(Object(s.i)(window.location.href)),t.isCreateNew&&(r.new="1",t.wopiPrecheckInfo.IsNewFileFromHostTemplate&&(r.wdTpl="fromhost"))),t.wopiPrecheckInfo.PreseededSessionKey&&(r.preseededSessionKey=encodeURIComponent(t.wopiPrecheckInfo.PreseededSessionKey)),t.wopiPrecheckInfo.PreseededWacSessionId&&(r.preseededWacSessionId=encodeURIComponent(t.wopiPrecheckInfo.PreseededWacSessionId)),t.wopiPrecheckInfo.RequestedCallThrottling&&(r.rct=t.wopiPrecheckInfo.RequestedCallThrottling),t.wopiPrecheckInfo.ClientThrottlingProtection&&(r.ctp=t.wopiPrecheckInfo.ClientThrottlingProtection),t.applicationCustomSettings&&t.applicationCustomSettings.additionalApplicationParameters&&(r=Object(i.a)(Object(i.a)({},t.applicationCustomSettings.additionalApplicationParameters),r)),t.rebootOverrideData&&t.rebootOverrideData.queryOverrides&&(r=Object(i.a)(Object(i.a)({},r),t.rebootOverrideData.queryOverrides)),function(t,e,n,o,r){var c=Object(s.r)(t);("teams"===c.uih&&"UnifiedUiHostTeams"!==e.UiHostIntegrationType||"owa"===c.uih)&&(c.hhdr="1");var a=t.indexOf("?"),u=-1===a?t.concat("?"):t.substring(0,a+1);e.UiLocale&&(c.ui=encodeURIComponent(e.UiLocale));e.DataLocale&&(c.rs=encodeURIComponent(e.DataLocale));e.HostSessionId&&(c.hid=encodeURIComponent(e.HostSessionId));e.DisableChat&&(c.dchat="1");e.SessionContext&&(c.sc=encodeURIComponent(e.SessionContext));n&&n.WopiSrc&&(c.wopisrc=encodeURIComponent(n.WopiSrc));e.CookieCompliant&&(c.mscc="1");o&&(o.entryPoint&&(c.wdorigin=encodeURI(o.entryPoint)),o.userClickTime&&(c.wdhostclicktime=o.userClickTime.toString()));c=Object(i.a)(Object(i.a)(Object(i.a)({},c),e.WdParams),r);var f={};for(var d in c)f[d.toLowerCase()]=c[d];var h=[];for(var d in f)f[d]&&h.push(d.concat("=",f[d]));return u.concat(h.join("&"))}(o,t.sessionInformation,t.wopiInfo,t.diagnostics.HostInitDiagnostics,r)}function D(t){return t.AccessTokenExpiry?t.AccessTokenExpiry.getTime().toString():"0"}var H,J=function(){function t(t,e,n,i,s,c){var f=this;if(this.fi=!1,this.di=function(t,e){f.hi.officeFrameCreateTime=Object(u.a)(),f.li.frameCreateStartTime=f.hi.officeFrameCreateTime;var n=f.pi.applicationCustomSettings&&f.pi.applicationCustomSettings.appFrameName;f.ci=M(f.pi.container,t,e,f.pi.featureManager,f.oi,f.pi.sessionId,n),f.Kn.activate(f.ci)},this.vi=function(t){f.Kn.registerMessagePayloadHandler(l.a.Tt,f.mi),f.Kn.registerMessagePayloadHandler(l.a.It,f.bi),f.Oi=window.setTimeout(f.wi,15e3),f.gi=new _.a(t,f.pi.Fe,f.oi,(function(){Object(a.a)(f.pi.remoteTelemetryUrl,T.a,"bootTimeout")}))},this.ji=function(t){var e=t&&t.state?t.state:"unknown";f.oi.ULS.Rn(595714271,o.a.Z,r.a.Info,"WAC Boot App state:[".concat(e,"]"))},this.Si=function(t){var e=Object(C.e)(f.oi);f.oi.ULS.Rn(595653903,o.a.Z,r.a.Info,"Top frame is trusted: ".concat(e)),f.Ii(b.a.Bt,{isTopFrameTrusted:e})},this.yi=function(t){var e=Object(P.b)(t&&t.overlayContent);f.oi.ULS.Rn(587487432,o.a.Z,r.a.Info,"Overlay content: ".concat(e)),f.Ii(b.a.jn,void 0)},this.mi=function(t){if(f.oi.ULS.Rn(595986314,o.a.Z,r.a.Info,"Received wac complete message"),f.oi.ULS.flush(),window.clearTimeout(f.Oi),f.gi&&f.gi.stop(),f.fi)f.oi.ULS.Rn(596444234,o.a.Z,r.a.Info,"Received multiple wac complete or failure messages");else{f.fi=!0,f.Ii(b.a.Qe,{}),g(f.hi,t);var e=f.Ti();f._i(e),f.Ci(f.pi.diagnostics)}},this.Pi=function(){f.oi.ULS.Rn(579342464,o.a.Z,r.a.Info,"Received close tab message");try{window.close()}catch(t){f.oi.ULS.Rn(579213188,o.a.Z,r.a.Warning,"Failed to close the browser tab")}},this.Ri=function(){var t=Object(m.c)(f.oi);t&&(f.pi.diagnostics.HostInitDiagnostics?f.pi.diagnostics.HostInitDiagnostics.hostResourceDownloadHighResTime=t:f.pi.diagnostics.HostInitDiagnostics={hostResourceDownloadHighResTime:t})},this.Ti=function(){return{innerApplicationFrame:f.ci}},this.bi=function(t){if(f.oi.ULS.Rn(595986315,o.a.Z,r.a.Error,"Received wac failed message"),f.oi.ULS.flush(),window.clearTimeout(f.Oi),f.gi&&f.gi.stop(),f.fi)f.oi.ULS.Rn(596444235,o.a.Z,r.a.Info,"Received multiple wac complete or failure messages");else{f.fi=!0,f.Ii(b.a.Xe,{});var e={errorType:w.a.WacFailed,errorObject:{}};t&&(e.errorObject=t.Error,f.li.error=e),f.Ai(e)}},this.Ui=function(t){var e=t.hostKey;f.oi.ULS.Rn(574433173,o.a.Z,r.a.Info,"GetHostKeyValue ".concat(e));var n=Object(R.b)(t);null!=n&&f.Ii(b.a.on,{hostKey:e,hostValue:n})},this.Ei=function(t){var e=t.hostKey,n=t.hostValue;f.oi.ULS.Rn(574433174,o.a.Z,r.a.Info,"storeHostKeyValue ".concat(e,": ").concat(n)),Object(A.b)(t)},this.wi=function(){f.fi||f.oi.ULS.Rn(596444236,o.a.Z,r.a.Warning,"Timeout. SessionTraces:"+JSON.stringify(f.li))},this.Ci=function(t){f.Ii(b.a.rn,{HostInitializeDiagnostics:t.HostInitDiagnostics,ClientDiagnostics:t.ClientDiagnostics})},this.Ii=function(t,e){f.ci&&f.ci.contentWindow?f.Kn.sendPostMessage(f.ci,t,e):f.oi.ULS.Rn(595955718,o.a.Z,r.a.Info,"Attempted to send postmessage: "+t)},void 0===e)throw new TypeError("bootFlowInfo");if(e.isSingleStepBoot&&void 0===t.wopiInfo)throw new TypeError("wopiInfo");this.pi=t,this.Wi=e,this.oi=n,this.Kn=i,this._i=s,this.Ai=c,this.hi=t.diagnostics.AppInitDiagnostics,this.li=t.diagnostics.SessionTraces,this.li.wopiInitializeTime=Object(u.a)()}return t.prototype.Boot=function(){this.oi.ULS.Rn(596444241,o.a.Z,r.a.Info,"Initializing WAC frame");var t=k(this.pi,this.Wi,!0),e=function(t,e){var n={};if(t.wopiInfo&&(n[C.a.Fi]=t.wopiInfo.AccessToken,n[C.a.Ni]=D(t.wopiInfo)),t.wopiPrecheckInfo.BundleInfo&&t.wopiPrecheckInfo.BundleInfo.Url&&t.wopiPrecheckInfo.BundleInfo.Url.length>0)if(n[C.a.xi]=t.wopiPrecheckInfo.BundleInfo.Url,null!=t.wopiPrecheckInfo.BundleInfo.BundleStaleness&&void 0!==t.wopiPrecheckInfo.BundleInfo.BundleStaleness){var i=t.wopiPrecheckInfo.BundleInfo.BundleStaleness.toString();e.ULS.Rn(593503580,o.a.Z,r.a.Info,"Content bundle staleness - "+i),n[C.a.Mi]=i}else e.ULS.Rn(593503581,o.a.Z,r.a.Info,"Content bundle staleness does not exist");if(t.wopiPrecheckInfo.FileGetUrl&&(n[C.a.ki]=t.wopiPrecheckInfo.FileGetUrl),t.wopiPrecheckInfo.CustomFontCatalogUrl&&(n[C.a.Di]=t.wopiPrecheckInfo.CustomFontCatalogUrl),t.wopiPrecheckInfo.FileName){var s=Object(v.a)(t.wopiPrecheckInfo.FileName);s&&(n[C.a.Hi]=s),n[C.a.Ji]=t.wopiPrecheckInfo.FileName}t.newFileTemplateSource&&t.newFileTemplateSource.FileSize?n[C.a.Bi]=t.newFileTemplateSource.FileSize.toString():t.wopiPrecheckInfo.FileSize&&(n[C.a.Bi]=t.wopiPrecheckInfo.FileSize.toString()),t.sessionInformation.UserId&&(n[C.a.Vi]=t.sessionInformation.UserId),t.sessionInformation.OwnerId&&(n[C.a.zi]=t.sessionInformation.OwnerId),t.sessionInformation.SessionContext&&(n[C.a.Li]=t.sessionInformation.SessionContext),t.diagnostics.HostInitDiagnostics&&(n[C.a.qi]=JSON.stringify({HostInitializeDiagnostics:t.diagnostics.HostInitDiagnostics,ClientDiagnostics:t.diagnostics.ClientDiagnostics})),n[C.a.Gi]=Object(U.b)(t.featureManager,t.sessionInformation.WdParams),t.applicationCustomSettings&&t.applicationCustomSettings.HostUIControls&&(n[C.a.Ki]=JSON.stringify(t.applicationCustomSettings.HostUIControls)),n[C.a.Zi]=String(window.devicePixelRatio>1.24),n[C.a.$i]=String(Object(h.f)()),n[C.a.Xi]=t.sessionInformation.HostName;var c=t.newFileTemplateSource;c&&c.FileGetUrl&&(n[C.a.Qi]=c.FileGetUrl),c&&c.DocUniqueId?n[C.a.Yi]=c.DocUniqueId:t.wopiPrecheckInfo.DocUniqueId&&(n[C.a.Yi]=t.wopiPrecheckInfo.DocUniqueId),c&&c.ETag?n[C.a.to]=c.ETag:t.wopiPrecheckInfo.ETag&&(n[C.a.to]=t.wopiPrecheckInfo.ETag),t.sessionInformation.ContentAssembly&&(n[C.a.eo]="1"),"Templatization"!==t.sessionInformation.ContentAssemblyMode&&"DocGen"!==t.sessionInformation.ContentAssemblyMode||(n[C.a.eo]="1");var a=t.sessionInformation.Meeting;return a&&(a.id&&(n[C.a.no]=a.id),a.title&&(n[C.a.io]=a.title),a.type&&(n[C.a.oo]=a.type),a.scheduledStartTime&&(n[C.a.ro]=a.scheduledStartTime),a.scheduledEndTime&&(n[C.a.ro]=a.scheduledEndTime),a.joinUrl&&(n[C.a.so]=encodeURIComponent(a.joinUrl)),a.organizerId&&(n[C.a.co]=a.organizerId),a.isPresenter&&(n[C.a.ao]=a.isPresenter.toString())),n}(this.pi,this.oi);if(this.Kn.registerMessagePayloadHandler(l.a.yt,this.ji),this.Kn.registerMessagePayloadHandler(l.a.Pt,this.Pi),this.Kn.registerMessagePayloadHandler(l.a.Bt,this.Si),this.Kn.registerMessagePayloadHandler(l.a.he,this.yi),this.Kn.registerMessagePayloadHandler(l.a.qt,this.Ui),this.Kn.registerMessagePayloadHandler(l.a.me,this.Ei),this.Wi.ignoreWacFramePostMessages||this.vi(Object(s.n)(t)),this.di(t,e),this.Wi.ignoreWacFramePostMessages){var n=this.Ti();this._i(n)}return this.oi.ULS.Rn(595661019,o.a.Z,r.a.Info,"Created Wac Frame"),this.ci},t}(),B=n(20),V=function(){function t(t,e,n,i,a,f,d){var h=this;this.uo=!1,this.fo=!1,this.do=!1,this.ho=null,this.lo=!0,this.po=!1,this.vo=!1,this.mo=function(){h.oi.ULS.Rn(596444231,o.a.Z,r.a.Info,"Initializing Office frame WITHOUT WOPI info - first step of two step flow."),window.setTimeout(h.bo,5e3),h.Kn.registerMessagePayloadHandler(l.a.St,h.Oo),h.Kn.registerMessagePayloadHandler(l.a.de,h.wo);var t=new J(h.pi,h.Wi,h.oi,h.Kn,h._i,h.Ai);h.ci=t.Boot()},this.jo=function(){var t={ParallelizeStartSession:h.lo,WacFrameIsLoaded:h.uo,WacAcceptsStartSessionComplete:h.po};h.oi.ULS.Rn(596444232,o.a.Z,r.a.Info,"Completing the initialized application WITH the WOPI info - second step of two step flow. Current app state - "+JSON.stringify(t)),!h.lo||h.uo&&!h.po?h.uo&&h.So():h.Io()},this.yo=function(){h.oi.ULS.Rn(596444233,o.a.Z,r.a.Info,"Initializing Office frame WITH WOPI info - single step WOPI boot flow."),h.pi.wopiInfo=h.To;var t=new J(h.pi,h.Wi,h.oi,h.Kn,h._i,h.Ai);h.ci=t.Boot()},this._o=function(t){h.uo?(h.oi.ULS.Rn(595968481,o.a.Z,r.a.Warning,"Fail called and wacframe is able to accept postmessages"),h.Co(t)):(h.oi.ULS.Rn(595968482,o.a.Z,r.a.Warning,"Fail was called on the session prior to WacReady."),h.ho=t)},this.Co=function(t){h.oi.ULS.Rn(596444189,o.a.Z,r.a.Warning,"Fail called, sending the failure postmessage to IFrame"),h.Ii(b.a.gn,t)},this.Po=function(){h.oi.ULS.Rn(596444190,o.a.Z,r.a.Warning,"Fail called during single step boot, calling host failure callback..."),h.Ai({errorType:w.a.InvalidWopiInfo,errorObject:new TypeError("wopiInfo")})},this.bo=function(){h.uo||(h.oi.ULS.Rn(596444191,o.a.Z,r.a.Warning,"Timeout Wac Ready"),h.Ai({errorType:w.a.TimeoutWacReady,errorObject:void 0}))},this.Ro=function(){h.do||(h.li.timeoutCompleteOrFail=Object(u.a)(),h.oi.ULS.Rn(596444192,o.a.Z,r.a.Warning,"Timeout Complete or Fail. SessionTraces:"+JSON.stringify(h.li)))},this.Ao=function(t,e,n){h.vo||(h.oi.ULS.Rn(596444193,o.a.Z,r.a.Info,"SessionCompletion timed out with no ack."),h.Uo(t,e,n+1))},this.Oo=function(t){if(h.li.readyMessageReceiveTime=Object(u.a)(),h.Ii(b.a.Ke,{}),h.uo)h.oi.ULS.Rn(596444194,o.a.Z,r.a.Info,"Received multiple ready messages - frame is already loaded.");else{h.uo=!0,h.po=t&&t.CanAcceptStartSessionComplete;var e={AcceptStartSessionComplete:h.po,ParallelizeStartSession:h.lo,StartSessionResponseAvailable:!!h.Eo,WopiInfoAvailable:!!h.To};h.oi.ULS.Rn(596444195,o.a.Z,r.a.Info,"HandleWacReadyMessage - "+JSON.stringify(e)),h.do&&(h.ho?h.Co(h.ho):h.Ii(b.a.Sn,{})),h.lo&&h.po?h.Eo&&h.Wo():h.To&&h.So(),g(h.hi,t)}},this.wo=function(t){h.vo=!0,h.li.sessionCompleteAckReceivedTime=Object(u.a)()},this.Ii=function(t,e){h.Kn.sendPostMessage(h.ci,t,e)},this.Fo=function(t,e){h.Uo(t,e,1)},this.Uo=function(t,e,n){if(n>3)h.oi.ULS.Rn(596444224,o.a.Z,r.a.Error,"Attempted to call complete, but received no ack from the frame. Time: ".concat(Object(u.a)()));else{h.oi.ULS.Rn(596444225,o.a.Z,r.a.Info,"Sending completion message to frame. Attempt number: ".concat(n,", Time: ").concat(Object(u.a)()));var i=Object(u.a)();1===n&&(h.Eo&&h.Eo.Diagnostics&&(h.Eo.Diagnostics.completeMessageCreateTime=i),h.li.completeMessageCreateTime=i),e.Diagnostics.completeMessageSendTime=i,h.li.completeMessageSendTime=i,h.Ii(t,e),window.setTimeout((function(){return h.Ao(t,e,n)}),1e3)}},this.Io=function(){h.oi.ULS.Rn(596444226,o.a.Z,r.a.Info,"Making parallelized startSession request.");var t=h.No(h.To),e={"Content-Type":"application/x-www-form-urlencoded"},n="access_token="+encodeURIComponent(h.To.AccessToken)+"&access_token_ttl="+encodeURIComponent(D(h.To));h.li.startSessionStartTime=Object(u.a)(),Object(O.a)(t,n,e,h.xo)},this.xo=function(t){if(h.li.startSessionCompleteTime=Object(u.a)(),h.li.startSessionResponseStatus=t.status,h.Eo={StartSessionResponse:{RequestStatus:t.status,ResponseText:t.responseText},Diagnostics:{wopiPendingInitializeTime:h.li.wopiPendingInitializeTime,wopiPendingCompleteTime:h.li.wopiPendingCompleteTime,startSessionStartTime:h.li.startSessionStartTime,startSessionCompleteTime:h.li.startSessionCompleteTime,readyMessageReceiveTime:h.li.readyMessageReceiveTime}},h.oi.ULS.Rn(596444227,o.a.Z,r.a.Info,"StartSession request completed with status code: ".concat(h.Eo.StartSessionResponse.RequestStatus,", Time: ").concat(Object(u.a)())),h.uo&&h.po)h.Wo();else{var e={WacFrameIsLoaded:h.uo,InitializeCompleted:h.fo};h.oi.ULS.Rn(596444228,o.a.Z,r.a.Info,"StartSessionCompleted not called - "+JSON.stringify(e))}},this.So=function(){if(!h.fo){h.fo=!0,h.oi.ULS.Rn(596444229,o.a.Z,r.a.Info,"Sending wopi info to the frame.");var t={WopiDetails:{WopiSrc:h.To.WopiSrc,AccessToken:h.To.AccessToken,AccessTokenTtl:D(h.To)},Diagnostics:{wopiPendingInitializeTime:h.li.wopiPendingInitializeTime,wopiPendingCompleteTime:h.li.wopiPendingCompleteTime,readyMessageReceiveTime:h.li.readyMessageReceiveTime}};h.Fo(b.a.tn,t)}},this.Wo=function(){200===h.Eo.StartSessionResponse.RequestStatus?h.fo||(h.fo=!0,h.Fo(b.a.Ye,h.Eo)):h.So()},this.No=function(t){var e=h.pi.applicationBasePath+F.g,n=k(h.pi,h.Wi,!1);return e+="?"+n.substring(n.indexOf("?")+1),e=Object(s.b)(e,"WOPISrc",encodeURIComponent(t.WopiSrc)),e=Object(s.b)(e,"build",encodeURIComponent(Object(c.a)())),e=Object(s.b)(e,"WacUserType",encodeURIComponent("WOPI")),h.pi.wopiPrecheckInfo.FileGetUrl&&(e=Object(s.b)(e,"fileGetUrlPresent","1")),e},this.Mo=function(t){if(h.pi.isCreateNew){if(!t||!t.NewFilePath)return void h.oi.ULS.Rn(596444230,o.a.Z,r.a.Error,"Either NewFileInfo or NewFilePath are not provided for a new file.");history.replaceState({},"",t.NewFilePath),t.UpdatedPageTitle&&(document.title=t.UpdatedPageTitle)}},this.pi=t,this.Wi=e,this.hi=t.diagnostics.AppInitDiagnostics,this.oi=n,this.Kn=i,this._i=f,this.Ai=d,this.li=t.diagnostics.SessionTraces,this.li.wopiPendingInitializeTime=Object(u.a)(),this.ko=a,Object(B.b)(),window.setTimeout(this.Ro,5e3)}return t.prototype.Complete=function(t,e){if(this.do)this.oi.ULS.Rn(596444184,o.a.Z,r.a.Warning,"Complete called after Complete/Fail already called");else{this.oi.ULS.Rn(596444185,o.a.Z,r.a.Info,"Complete called."),this.do=!0,this.To=t,this.li.wopiPendingCompleteTime=Object(u.a)();try{this.Wi.isSingleStepBoot?this.yo():this.jo(),this.uo&&this.Ii(b.a.Sn,{}),this.Mo(e)}catch(t){this.oi.ULS.Rn(596444186,o.a.Z,r.a.Error,"Unexpected script error: ".concat(Object(v.b)(t))),Object(a.a)(this.pi.remoteTelemetryUrl,T.a,"bootException")}finally{this.oi.ULS.flush()}}},t.prototype.Fail=function(t){this.do?this.oi.ULS.Rn(596444187,o.a.Z,r.a.Warning,"Fail called after Complete/Fail already called"):(this.oi.ULS.Rn(596444188,o.a.Z,r.a.Warning,"Fail called. Reason: "+(t?JSON.stringify(t):"N/A")),this.do=!0,this.Wi.isSingleStepBoot?this.Po():this._o(t),this.oi.ULS.flush())},t.prototype.Dispose=function(t,e,n){var i=this;Object(B.a)(t||!1,this.oi,this.Kn,this.ci,(function(){delete i.ci,e&&e(),i.ko(),i.Kn.dispose()}),void 0,n)},t.prototype.Boot=function(){this.Wi.isSingleStepBoot||this.mo(),this.oi.ULS.flush()},t}(),z=function(){function t(t,e,n,i,s,c,a){var f=this;this.Do=!1,this.Ho=!1,this.Jo=!1,this.Bo=function(t,e){f.Kn.sendPostMessage(t,b.a.in,{HostCacheLoadTime:e})},this.Vo=function(t,e,n,i){if(f.oi.ULS.Rn(595989254,o.a.N,r.a.Info,"Kick off OptimizationView"),!f.pi.applicationCustomSettings||!f.pi.applicationCustomSettings.ForceAccessibilityMode)if(t.Url){var s=e.ownerDocument;if(s){f.zo=s.createElement("div"),f.zo.id="FirstPageContainer",f.zo.style.left="0",f.zo.style.textAlign="center",f.zo.style.width="1px",f.zo.style.bottom="0",f.zo.style.zIndex="900",f.zo.style.height="1px",f.zo.style.position="absolute",f.zo.style.padding="0 29px",f.zo.style.right="0",f.zo.style.overflow="auto",f.zo.style.marginLeft="auto",f.zo.style.marginRight="auto",f.zo.style.maxWidth="100%",f.Lo?f.zo.style.top="0":f.zo.style.top="90px",e.appendChild(f.zo);var c=s.createElement("img");c.id="FirstPageImage",c.style.marginTop="11px",c.style.marginBottom="11px",c.style.maxWidth="100%",c.style.border="solid 1px #d2d5d8",c.draggable=!1,c.onload=function(){f.oi.ULS.Rn(595989255,o.a.N,r.a.Info,"OptimizationView Loaded"),f.zo.style.width="",f.zo.style.height="",n()},c.onerror=function(t){i({errorType:w.a.CannotLoadFirstPage,errorObject:"string"==typeof t?t:t.returnValue})},c.src=t.Url.replace("{0}","p1.img"),f.zo.appendChild(c)}}else f.oi.ULS.Rn(595722645,o.a.N,r.a.Info,"Missing Url in provided Bundle Info, from host: "+f.pi.sessionInformation.HostName)},this.qo=function(){if(!f.Ho&&f.Do&&(!f.Lo||f.Go&&f.Ko&&f.Zo)){f.Kn.removeMessageHandler(l.a.ge),f.Kn.removeMessageHandler(l.a.ee),f.Kn.removeMessageHandler(l.a.Te);var t={isCore:f.Lo,pageCount:f.Ko,currentPage:f.Go,zoomLevel:f.Zo,innerApplicationFrame:f.ci};f._i(t),f.oi.ULS.Rn(595989256,o.a.N,r.a.Info,"Word Viewer Initialize Complete"),f.Ho=!0,f.oi.ULS.flush()}},this.$o=function(t){f.oi.ULS.Rn(595986312,o.a.N,r.a.Info,"SuccessCallbackProxy called"),f.ci=t.innerApplicationFrame,f.Xo&&f.Bo(f.ci,f.Xo),f.Qo();var e=f.hi.documentLoadedTime;e&&f.Xo&&f.Xo<e?(f.hi.documentLoadedTime=f.Xo,f.hi.documentLoadedFromWopiPrecheckInfo=!0,f.oi.ULS.Rn(595994572,o.a.N,r.a.Info,"First page load from cache was faster")):f.hi.documentLoadedFromWopiPrecheckInfo=!1,f.Yo(),f.Do=!0,f.oi.ULS.Rn(595986313,o.a.N,r.a.Info,"WordViewerInitializer received wac complete message"),f.qo(),f.oi.ULS.flush()},this.tr=function(t){f.oi.ULS.Rn(595972122,o.a.N,r.a.Error,"FailureCallbackProxy called"),f.Ho=!0,f.Ai(t)},this.Qo=function(){f.zo&&f.zo.parentElement&&f.zo.parentElement.removeChild(f.zo)},this.er=function(){if(!f.Ho){f.li.timeoutAppInitialize=Object(u.a)();var t="Didn't receive app initialize post messages. {'appComplete': "+f.Do+", 'currentPage': "+(void 0!==f.Go)+", 'zoomLevel': "+(void 0!==f.Zo)+", 'pageCount': "+(void 0!==f.Ko)+"}";f.oi.ULS.Rn(596120771,o.a.N,r.a.Warning,t)}},this.nr=function(t){if(!t||"number"!=typeof t.pageCount)throw new TypeError("values: PageCount not found");f.Ko=t.pageCount,f.Ii(b.a.Tn,{}),f.qo()},this.ir=function(t){if(!t||"number"!=typeof t.newPage)throw new TypeError("values: CurrentPage not found");f.Go=t.newPage,f.Ii(b.a.sn,{}),f.qo()},this.or=function(t){if(!t||"number"!=typeof t.newLevel)throw new TypeError("values: ZoomLevel not found");f.Zo=t.newLevel,f.Ii(b.a._n,{}),f.qo()},this.Yo=function(){f.Go&&f.Ii(b.a.sn,{}),f.Ko&&f.Ii(b.a.Tn,{}),f.Zo&&f.Ii(b.a._n,{})},this.Ii=function(t,e){f.ci&&f.ci.contentWindow?f.Kn.sendPostMessage(f.ci,t,e):f.oi.ULS.Rn(595955717,o.a.N,r.a.Info,"Attempted to send WordViewer postmessage: "+t)},this.pi=t,this.hi=t.diagnostics.AppInitDiagnostics,this.oi=n,this.Kn=i,this.li=t.diagnostics.SessionTraces,this.ko=s;var d=window.navigator.userAgent;d.indexOf("Mobi")>=0&&d.indexOf("iPad")<0&&(this.Jo=!0),this._i=c,this.Ai=a,this.rr=this.Jo?c:this.$o,this.sr=this.Jo?a:this.tr,this.Lo=!(!this.pi.applicationCustomSettings||!this.pi.applicationCustomSettings.IsCore),this.pi.sessionInformation&&this.pi.sessionInformation.WdParams&&(this.pi.applicationCustomSettings&&this.pi.applicationCustomSettings.ForceAccessibilityMode?this.pi.sessionInformation.WdParams.wdAccPdf="1":this.Lo&&(this.pi.sessionInformation.WdParams.wdAccPdf="0")),this.cr=new V(this.pi,e,n,i,s,this.rr,this.sr)}return t.prototype.Complete=function(t){this.pi.diagnostics.HostInitDiagnostics&&(this.pi.diagnostics.HostInitDiagnostics.hostCompleteCallTime=Object(u.a)()),this.cr.Complete(t)},t.prototype.Fail=function(t){this.cr.Fail(t)},t.prototype.Dispose=function(t,e,n){var i=this;Object(B.a)(t||!1,this.oi,this.Kn,this.ci,(function(){delete i.ci,e&&e(),i.ko(),i.Kn.dispose()}),void 0,n)},t.prototype.Boot=function(){var t=this;if(this.Jo)this.oi.ULS.Rn(595932544,o.a.N,r.a.Info,"Mobile Endpoint detected, skipping first page viewer optimization");else{this.oi.ULS.Rn(595989253,o.a.N,r.a.Info,"Boot WordViewer"),this.Kn.registerMessagePayloadHandler(l.a.ge,this.nr),this.Kn.registerMessagePayloadHandler(l.a.ee,this.ir),this.Kn.registerMessagePayloadHandler(l.a.Te,this.or);var e=this.pi.rebootOverrideData;e&&e.reason&&"translate"===e.reason.toLowerCase()?this.oi.ULS.Rn(591209105,o.a.N,r.a.Info,"Skip first page optimization"):this.pi.wopiPrecheckInfo.BundleInfo?this.Vo(this.pi.wopiPrecheckInfo.BundleInfo,this.pi.container,(function(){t.Xo=Object(u.a)(),t.oi.ULS.Rn(595998873,o.a.N,r.a.Info,"FirstPageFromHostLoadTime: "+t.Xo),t.hi.documentLoadedTime=t.hi.documentLoadedTime||t.Xo,t.ci&&t.ci.contentWindow&&t.Bo(t.ci,t.Xo)}),(function(e){t.Qo(),t.oi.ULS.Rn(595994571,o.a.N,r.a.Warning,"Cannot load first page from cache"),t.hi.errorObject=e})):this.oi.ULS.Rn(596121033,o.a.N,r.a.Warning,"Missing Bundle Info"),window.setTimeout(this.er,6e4)}},t}(),L=n(37),q=((H={})[L.a.blurFocus]=b.a.$e,H[L.a.continueAccessibilityLoop]=b.a.en,H[L.a.grabFocus]=b.a.nn,H[L.a.moveToFolder]=b.a.Xt,H[L.a.popState]=b.a.cn,H[L.a.rename]=b.a.an,H[L.a.sendAccessToken]=b.a.un,H[L.a.sendAuthToken]=b.a.fn,H[L.a.sendCustomAuthConfig]=b.a.dn,H[L.a.sendEmbeddedViewUrl]=b.a.ln,H[L.a.sendSessionInfo]=b.a.pn,H[L.a.sendUserAccessAndPermissions]=b.a.vn,H[L.a.sendWopiInfo]=b.a.mn,H[L.a.sendDavUrl]=b.a.bn,H[L.a.completeSharedFilePicker]=b.a.ue,H[L.a.switchMode]=b.a.In,H[L.a.signalShared]=b.a.Cn,H),G=function(){function t(t,e){var n=this;if(this.ar=!1,this.qn={},this.ur="",this.dr="",this.hr=!1,this.lr=!1,this.pr=!1,this.vr=[],this.mr=!0,this.br=function(t,e,i){if(t){var s={MessageId:b.a.Ge,CorrelationId:i,SendTime:Object(u.a)()};n.oi.ULS.Rn(595732176,o.a.Z,r.a.Info,"Sending Ack back"),t.postMessage(JSON.stringify(s),e)}else n.oi.ULS.Rn(595736136,o.a.Z,r.a.Info,"Missing target to send Ack back")},this.Or=function(t){var e=!1,i=!0,c="",a=!1;if(n.ci&&n.ci.contentWindow&&(e=!0,i=t.source===n.ci.contentWindow),t.origin&&(a=(c=Object(s.h)(t.origin,2).toLowerCase())===n.dr),!n.lr&&(!n.pr||a&&i)||n.oi.ULS.Rn(595730526,o.a.Z,r.a.Info,"Window is available: ".concat(e,", window is valid: ").concat(i,", origin is valid: ").concat(a,", expected origin: ").concat(n.dr,", actual origin: ").concat(c)),a&&(!n.hr||i)){var u;try{u=JSON.parse(t.data)}catch(t){return void n.oi.ULS.Rn(596464282,o.a.Z,r.a.Info,"Failed to parse event data: ".concat(Object(v.b)(t),"."))}var f=u.MessageId;if(f){n.oi.ULS.Rn(595714715,o.a.Z,r.a.Info,"Received messageId: ".concat(f,", correlation: ").concat(u.CorrelationId)),f!==l.a.Tt&&f!==l.a.Zt||n.wr(t.origin),u.Values&&u.Values.ackExpected&&n.br(t.source,t.origin,u.CorrelationId);var d=n.qn[f];if(!d)return n.oi.ULS.Rn(596464289,o.a.Z,r.a.Info,"No handler found for message id: ".concat(f)),void(n.mr&&f===l.a.zt&&(n.vr.push(u),n.oi.ULS.Rn(543207888,o.a.Z,r.a.Info,"Kept for later process: ".concat(f))));n.oi.ULS.Rn(596464288,o.a.Z,r.a.Info,"Processing message: ".concat(f));try{d(u.Values||{})}catch(t){n.oi.ULS.Rn(593773704,o.a.Z,r.a.Error,"Handler error: ".concat(Object(v.b)(t)))}n.mr&&f===l.a.Tt&&n.gr()}else(n.lr||n.pr)&&n.oi.ULS.Rn(595730520,o.a.Z,r.a.Info,"Could not find message id")}},this.gr=function(){n.mr=!1,n.vr.forEach((function(t){var e=t.MessageId,i=n.qn[e];if(i){n.oi.ULS.Rn(543207890,o.a.Z,r.a.Info,"Processing message after boot complete: ".concat(e));try{i(t.Values||{})}catch(t){n.oi.ULS.Rn(543207891,o.a.Z,r.a.Error,"Handler error: ".concat(Object(v.b)(t)))}}else n.oi.ULS.Rn(543207889,o.a.Z,r.a.Info,"No handler found after boot complete: ".concat(e))})),n.vr=[]},this.jr=function(t,e,n){t.postMessage(e,n)},this.wr=function(t){var e=t.toLowerCase();n.ur&&n.ur!==e&&n.oi.ULS.Rn(596128131,o.a.Z,r.a.Warning,"Updating origin: [".concat(Object(s.g)(n.ur),"]->[").concat(Object(s.g)(e),"]")),n.ur=e,n.dr=Object(s.h)(e,2),n.lr=Object(s.n)(e),n.pr=Object(s.o)(e)},!t)throw new Error("Missing origin for PostMessageHandler");this.lr=Object(s.n)(t),this.pr=Object(s.o)(t),this.oi=e,this.wr(t)}return t.prototype.registerMessagePayloadHandler=function(t,e){if(this.qn[t])throw new Error("Duplicate registration!");this.qn[t]=e},t.prototype.removeMessageHandler=function(t){delete this.qn[t]},t.prototype.sendPostMessage=function(t,e,n){if(t&&t.contentWindow){this.oi.ULS.Rn(596464334,o.a.Z,r.a.Info,"Sending message: "+e);var i={MessageId:e,SendTime:Object(u.a)(),Values:n};this.jr(t.contentWindow,JSON.stringify(i),this.ur)}else this.oi.ULS.Rn(595948308,o.a.Z,r.a.Info,"Missing target for SendPostMessage")},t.prototype.activate=function(t,e){this.ci=t,this.hr=!!e,this.ar||(window.addEventListener("message",this.Or,!1),this.ar=!0)},t.prototype.postMessageForCommand=function(t,e,n){var i=q[e];i?(this.oi.ULS.Rn(595702598,o.a.Z,r.a.Info,"Sending message ".concat(i," for command ").concat(e)),this.sendPostMessage(t,i,n)):this.oi.ULS.Rn(595702599,o.a.Z,r.a.Warning,"No mapping for command ".concat(e))},t.prototype.dispose=function(){this.qn={},this.ar&&(window.removeEventListener("message",this.Or,!1),this.ar=!1)},t}(),K=function(){function t(){var t=this;if(this.Sr=[],this.qn=[],this.Ir=function(){var e={visibility:document.visibilityState,time:Object(u.a)(),initialState:!1};t.Sr.push(e);for(var n=0,i=t.qn;n<i.length;n++){var o=i[n];o&&o(e)}},"hidden"===document.visibilityState){var e={visibility:document.visibilityState,time:Object(u.a)(),initialState:!0};this.Sr.push(e)}document.addEventListener("visibilitychange",this.Ir)}return t.prototype.registerEventHandler=function(t){this.qn.push(t)},t.prototype.removeEventHandler=function(t){if(t){var e=this.qn.indexOf(t);this.qn.splice(e,1)}},t.prototype.stop=function(){document.removeEventListener("visibilitychange",this.Ir)},t.prototype.getVisibilityChangeEvents=function(){return this.Sr},t.prototype.dispose=function(){this.stop(),this.qn=[],this.Sr=[]},t}();n.d(e,"a",(function(){return Z}));var Z=function(){function t(t,e){var n=this;this.yr=function(t,e){return window.setInterval((function(){n.Prefetch({BootstrapperUrl:t}),e.ULS.Rn(595895774,o.a.Z,r.a.Info,"Prefetching "+Object(s.j)(t))}),36e5)},this.Tr=t,this._r=e}return t.prototype.GetVersion=function(){return Object(c.a)()},t.prototype.GetMinContentVersion=function(){throw new Error("Not implemented")},t.prototype.Prefetch=function(t){if(null!=t&&void 0!==t){var e=document.createElement("link");e.rel="prefetch";var n=t.BootstrapperUrl;".js"!==n.toString().slice(-3)&&(n+=".js"),e.href=n;var i=document.getElementsByTagName("head")[0];null!=i&&void 0!==i&&i.appendChild(e)}},t.prototype.InitializeWopiPending=function(t,e,n,i,c,b){var O,g,_,C,P,R=!1;try{Object(a.a)(Object(T.d)(t.ApplicationUrl),T.a,"init");var A,U=Object(u.a)();!function(t){if(void 0===t)throw new TypeError("initParams");var e=t.Container;if(void 0===e||void 0===e.appendChild)throw new TypeError("Container");var n=t.SessionInformation;if(void 0===n||void 0===n.HostName||void 0===n.HostSessionId||void 0===n.UserId)throw new TypeError("SessionInformation");var i=t.ApplicationUrl;if(void 0===i||"string"!=typeof i)throw new TypeError("ApplicationUrl");var o=t.WopiPrecheckInfo;if(void 0===o||void 0===o.FileName)throw new TypeError("WopiPrecheckInfo");if(void 0===t.FnOnInitializeSuccess)throw new TypeError("FnOnInitializeSuccess");if(void 0===t.FnOnInitializeFailure)throw new TypeError("FnOnInitializeFailure")}(t),t.ApplicationUrl=Object(s.u)(t.ApplicationUrl,Object(s.k)(t.ApplicationUrl,"region")),t.ApplicationUrl=Object(s.w)(t.ApplicationUrl,"region"),function(t){var e,n=t.RebootOverrideData;n&&(e=n.mode)&&("view"===(e=e.toLowerCase())&&Object(F.a)(t.ApplicationUrl)?t.ApplicationUrl=Object(F.c)(t.ApplicationUrl):"edit"===e&&Object(F.b)(t.ApplicationUrl)&&(t.ApplicationUrl=Object(F.d)(t.ApplicationUrl)))}(t),n?_=n:(_=(O=Object(f.a)())[0],C=O[1]),g=e||Object(d.a)({remoteUlsEndpoint:Object(T.b)(t.ApplicationUrl)+s.t,sessionId:_}),P=Object(T.c)(t,_,g,c,b,this._r.forceSingleStepBoot),b||(P.Fe.addSettingsChangeListener(g.settingsChangeHandler),P.Fe.initializePeriodicFetch(P.applicationBasePath,_)),P.diagnostics.HostInitDiagnostics&&(P.diagnostics.HostInitDiagnostics.hostInitializeCallTime=U),I(g,P,C),R=!0;var E=t.BootstrapperUrl;E&&(A=this.yr(E,g));var W=function(){P.Fe.dispose(),P.pageStateObserver.dispose(),window.clearInterval(A)},N=Object(s.i)(t.ApplicationUrl),M=i||new G(N,g),k=new K,D=x(P,g),H=function(t,e,n,i,s,c,u){return function(f){var d=t.diagnostics;S(d,i),j(d.SessionTraces,n,r.a.Info);var h=X(d);n.ULS.Rn(596448985,o.a.Z,r.a.Info,JSON.stringify(h)),Object(a.a)(t.remoteTelemetryUrl,T.a,"bootSuccess");var l=u(t.sessionId,n,e,s,f);try{c(l,h)}catch(t){n.ULS.Rn(595719171,o.a.Z,r.a.Error,"Exception thrown from host's success callback: ".concat(Object(v.b)(t)))}Object(m.g)("word",n),$(n)}}(P,M,g,k,W,t.FnOnInitializeSuccess,this.Tr),J=function(t,e,n,i){return function(s){var c=t.diagnostics;S(c,n),j(c.SessionTraces,e,r.a.Warning);var u=X(c);e.ULS.Rn(596448986,o.a.Z,r.a.Error,JSON.stringify({error:s,appInitDiagnostics:u})),Object(a.a)(t.remoteTelemetryUrl,T.a,"bootFailure");try{i(s,u)}catch(t){e.ULS.Rn(595719172,o.a.Z,r.a.Error,"Exception thrown from host's failure callback: ".concat(Object(v.b)(t)))}Object(m.g)("word",e),$(e)}}(P,g,k,t.FnOnInitializeFailure);if(Object(h.b)(),t.FnOnAppModeSwitched&&M.registerMessagePayloadHandler(l.a.$t,t.FnOnAppModeSwitched),this._r.useViewerInitializer||D.bootFlowType===y.unifiedViewActionUrl||D.bootFlowType===y.wordUiEmbedReadOnlyEarlyRedirect||D.bootFlowType===y.wordUiEmbedIrmEnabledEarlyRedirect){!this._r.useViewerInitializer&&t.FnOnAppModeSwitched&&t.FnOnAppModeSwitched({NewMode:"view"}),D.bootFlowType===y.wordUiEmbedReadOnlyEarlyRedirect&&(P.applicationUrl=Object(F.c)(P.applicationUrl,!0)),P.sessionInformation.HideViewerToolbar&&(P.applicationCustomSettings?P.applicationCustomSettings.IsCore=!0:P.applicationCustomSettings={IsCore:!0},delete P.sessionInformation.HideViewerToolbar);var B=new z(P,D,g,M,W,H,J);return B.Boot(),B}D.bootFlowType===y.wordViewToUnifiedReadRedirect&&(g.ULS.Rn(578324612,o.a.Z,r.a.Info,"Redirecting Viewer request to unified read"),P.applicationUrl=Object(F.d)(P.applicationUrl)),t.WopiPrecheckInfo.ReadOnly&&t.FnOnAppModeSwitched&&t.FnOnAppModeSwitched({NewMode:"view"});var L=Object(s.k)(P.applicationUrl,"uih");if(E&&this._r.preconnector&&this._r.preconnector.shouldPreconnect(L)&&this._r.preconnector.preconnect(E),E&&this._r.preloader&&this._r.preloader.shouldPreload(P.applicationUrl))try{var q=E;P.featureManager.isFeatureEnabled(p.a.Fn)&&(g.ULS.Rn(595645891,o.a.Z,r.a.Info,"HTTP2 preload enabled"),q=Object(s.v)(E));var Z=P.sessionInformation.UiLocale;Z||(Z=decodeURIComponent(Object(s.k)(P.applicationUrl,"ui"))),this._r.preloader.preload(q,Z,g,P.featureManager)}catch(t){g.ULS.Rn(595943884,o.a.Z,r.a.Error,Object(v.b)(t))}var Q=new V(P,D,g,M,W,H,J);return Q.Boot(),Q}catch(e){return g&&(g.ULS.Rn(596459925,o.a.Z,r.a.Error,"".concat(w.a.AppInitError,": ").concat(Object(v.b)(e))),R||I(g,P||Object(T.c)(t,_,g,c,b,this._r.forceSingleStepBoot),C),g.ULS.flushOnClose()),void(t&&(t.ApplicationUrl&&Object(a.a)(Object(T.d)(t.ApplicationUrl),T.a,"bootException"),t.FnOnInitializeFailure&&t.FnOnInitializeFailure({errorType:w.a.AppInitError,errorObject:e})))}},t}();function $(t){t.ULS.Rn(590914655,o.a.Z,r.a.Info,"Time spent logging: ".concat(t.getTimeSpentLogging()))}function X(t){return Object(i.a)(Object(i.a)(Object(i.a)({},t.AppInitDiagnostics),t.HostInitDiagnostics),{SessionTraces:t.SessionTraces})}},,,,function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var i=function(){function t(t){var e=this;this.Cr=!1,this.Pr=[],this.cancel=function(){e.Cr||(e.Cr=!0,e.Pr.map((function(t){return t()})),e.Pr=[])},this.Rr=t,window.setTimeout(this.cancel,t)}return Object.defineProperty(t.prototype,"isCancelled",{get:function(){return this.Cr},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Ar",{get:function(){return this.Rr},enumerable:!1,configurable:!0}),t.prototype.subscribe=function(t){this.Cr?t():this.Pr.push(t)},t}();function o(t){return new i(t)}},function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),function(t){t.AccessibilityLoopCompleted="AccessibilityLoopCompleted",t.ActionCompleted="ActionCompleted",t.BrowserEvent="BrowserEvent",t.Close="Close",t.Conversation="Conversation",t.CopyAndEdit="CopyAndEdit",t.CreateNewDocument="CreateNewDocument",t.Download="Download",t.Edit="Edit",t.Error="Error",t.FileEmbed="FileEmbed",t.FileProperties="FileProperties",t.FileRenamed="FileRenamed",t.FileVersions="FileVersions",t.FrameStateChanged="FrameStateChanged",t.GetAccessToken="GetAccessToken",t.GetAuthToken="GetAuthToken",t.GetCustomAuthConfig="GetCustomAuthConfig",t.GetWopiInfoFromUrl="GetWopiInfoFromUrl",t.GetDavUrlFromIds="GetDavUrlFromIds",t.ModeSwitched="ModeSwitched",t.MoveToFolder="MoveToFolder",t.OpenInMobileApp="OpenInMobileApp",t.OpenInBrowser="OpenInBrowser",t.OpenInClient="OpenInClient",t.PageChanged="PageChanged",t.PushState="PushState",t.Reboot="Reboot",t.RedeemForCommenting="RedeemForCommenting",t.RefreshSessionInfo="RefreshSessionInfo",t.ReplyWithChanges="ReplyWithChanges",t.ReportAbuse="ReportAbuse",t.SharedFilePicker="SharedFilePicker",t.SaveStatus="SaveStatus",t.Share="Share",t.ShareForm="ShareForm",t.SignIn="SignIn",t.UserAccessAndPermissions="UserAccessAndPermissions",t.UserActivity="UserActivity",t.UserEditActivity="UserEditActivity",t.Workflow="Workflow",t.ZoomChanged="ZoomChanged"}(i||(i={}))},function(t,e,n){"use strict";function i(t){return!(!(t&&t.source&&t.accessToken)||!t.expiry&&0!==t.expiry)}n.d(e,"a",(function(){return i}))},function(t,e,n){"use strict";var i,o=n(32),r=n(0),s=n(1),c=n(87),a=n(95),u=n(52),f=n(50),d=n(110),h=n(37),l=n(9),p=n(17),v=n(43),m=((i={})[h.a.boot]={Ur:d.a.boot},i[h.a.createNew]={Ur:d.a.createNew},i[h.a.dispose]={Ur:d.a.dispose},i[h.a.rename]={Ur:d.a.rename},i[h.a.switchMode]={Ur:d.a.switchMode},i[l.a.yt]={Ur:d.a.handleBootState},i[l.a.Pt]={Ur:d.a.closeTab},i[l.a.Bt]={Ur:d.a.frameTrust},i[l.a.zt]={Ur:d.a.getAuthToken},i[l.a.qt]={Ur:d.a.getHostKeyValue},i[l.a.oe]={Ur:d.a.appReboot},i[l.a.he]={Ur:d.a.setOverlayContent},i[l.a.me]={Ur:d.a.storeHostKeyValue},i[l.a.we]={Ur:d.a.updateBootComplete},i[h.a.blurFocus]={Er:p.a.$e},i[h.a.continueAccessibilityLoop]={Er:p.a.en},i[h.a.grabFocus]={Er:p.a.nn},i[h.a.moveToFolder]={Er:p.a.Xt},i[h.a.popState]={Er:p.a.cn},i[h.a.completeSharedFilePicker]={Er:p.a.ue},i[l.a.gt]={Wr:v.a.AccessibilityLoopCompleted},i[l.a.jt]={Wr:v.a.ActionCompleted},i[l.a._t]={Wr:v.a.BrowserEvent},i[l.a.Ct]={Wr:v.a.Close},i[l.a.Rt]={Wr:v.a.Conversation},i[l.a.At]={Wr:v.a.CopyAndEdit},i[l.a.Ut]={Wr:v.a.CreateNewDocument},i[l.a.Wt]={Wr:v.a.Download},i[l.a.Ft]={Wr:v.a.Edit},i[l.a.Nt]={Wr:v.a.Error},i[l.a.Mt]={Wr:v.a.FileProperties},i[l.a.kt]={Wr:v.a.FileRenamed},i[l.a.Ht]={Wr:v.a.FileVersions},i[l.a.Jt]={Wr:v.a.FrameStateChanged},i[l.a.$t]={Wr:v.a.ModeSwitched},i[l.a.Xt]={Wr:v.a.MoveToFolder},i[l.a.Qt]={Wr:v.a.OpenInMobileApp},i[l.a.Yt]={Wr:v.a.OpenInBrowser},i[l.a.te]={Wr:v.a.OpenInClient},i[l.a.ee]={Wr:v.a.PageChanged},i[l.a.ie]={Wr:v.a.PushState},i[l.a.re]={Wr:v.a.RedeemForCommenting},i[l.a.ce]={Wr:v.a.ReplyWithChanges},i[l.a.ue]={Wr:v.a.SharedFilePicker},i[l.a.ae]={Wr:v.a.ReportAbuse},i[l.a.fe]={Wr:v.a.SaveStatus},i[l.a.pe]={Wr:v.a.ShareForm},i[l.a.ve]={Wr:v.a.SignIn},i[l.a.Se]={Wr:v.a.UserActivity},i[l.a.Ie]={Wr:v.a.UserEditActivity},i[l.a.ye]={Wr:v.a.Workflow},i[l.a.Te]={Wr:v.a.ZoomChanged},i[l.a.xt]={Fr:{Wr:v.a.FileEmbed,Nr:h.a.sendEmbeddedViewUrl,xr:p.a.ln,Ar:5e3}},i[l.a.Vt]={Fr:{Wr:v.a.GetAccessToken,Nr:h.a.sendAccessToken,xr:p.a.un}},i[l.a.Lt]={Fr:{Wr:v.a.GetCustomAuthConfig,Nr:h.a.sendCustomAuthConfig,xr:p.a.dn,Ar:5e3}},i[l.a.Gt]={Fr:{Wr:v.a.GetWopiInfoFromUrl,Nr:h.a.sendWopiInfo,xr:p.a.mn,Ar:5e3}},i[l.a.Kt]={Fr:{Wr:v.a.GetDavUrlFromIds,Nr:h.a.sendDavUrl,xr:p.a.bn,Ar:5e3}},i[l.a.se]={Fr:{Wr:v.a.RefreshSessionInfo,Nr:h.a.sendSessionInfo,xr:p.a.pn,Ar:5e3}},i[l.a.je]={Fr:{Wr:v.a.UserAccessAndPermissions,Nr:h.a.sendUserAccessAndPermissions,xr:p.a.vn,Ar:5e3}},i[l.a.le]={Fr:{Wr:v.a.Share,Nr:h.a.signalShared,xr:p.a.Cn,Ar:5e3}},i),b=n(42),O=n(8),w=n(88),g=n(51),j=n(53),S=n(54);n.d(e,"a",(function(){return I}));var I=function(){function t(t,e,n,i,d,h,l){var p,v=this;this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.pendingReboot=!1,this.skipWopiValidation=!1,this.useAdditionalDiv=!1,this.appContext={},this.appUrl="",this.appBaseUrl="",this.appBasePath="",this.remoteTelemetryUrl="",this.Mr={},this.onMessage=function(t){var e=t.MessageId,n=t.Values||{},i=v.Mr[e];if(i&&i.length>0)v.kr(e,n);else{var o=m[e];if(o){var c=o.Ur,a=o.Wr,u=o.Fr;c?(v.logger.ULS.Rn(574654543,r.a.Z,s.a.Info,"Running flow: ".concat(c)),v.Dr[c](e,n,v,v.Hr[c]).catch((function(t){v.Jr(c,t)}))):a?v.raiseEvent(a,n):u&&v.Br(u,n)}}},this.Jr=function(t,e){v.logger.ULS.Rn(596459925,r.a.Z,s.a.Error,"".concat(t," flow error: ").concat(Object(O.b)(e))),v.remoteTelemetryUrl&&Object(c.a)(v.remoteTelemetryUrl,v.appInfo.name,"flowException")},this.kr=function(t,e){v.logger.ULS.Rn(574654544,r.a.Z,s.a.Info,"Dispatching action: ".concat(t));for(var n=v.Mr[t].slice().reverse(),i=n.length-1;i>-1;i-=1)try{n[i](t,e)}catch(e){v.logger.ULS.Rn(596444186,r.a.Z,s.a.Error,"".concat(t," action handler error: ").concat(Object(O.b)(e)))}return Promise.resolve({completion:"success"})},this.Br=function(t,e){var n=function(e,n){v.container&&v.container.postMessage(t.xr,n),i()},i=function(){v.removeActionHandler(t.Nr,n)};(v.addActionHandler(t.Nr,n),void 0!==t.Ar)&&new b.a(t.Ar).subscribe(i);v.raiseEvent(t.Wr,e)},this.state=o.a.Unknown;var I=Object(w.a)(),y=I[0],T=I[1];this.logger=Object(a.a)(),this.logger.ULS.Rn(593506837,r.a.Z,s.a.Info,JSON.stringify(T)),this.sessionId=y,this.hostSessionId=n.hostSessionId,this.host=t.host,this.hostName=this.host.uiHostName||this.host.storageHostName,this.user=t.user,this.bootstrapperUrl=t.bootstrapperUrl,this.ui=t.ui||{},this.viewMode=t.viewMode,this.application=i,this.appInfo=e,this.session=d,this.featureManager=Object(u.a)(t.host.capabilities&&t.host.capabilities.isFeatureEnabledCallback,this.logger),this.Fe=new f.a(e.name,this.logger),this.preloader=e.preloader,p=h(this.featureManager),this.Dr=p[0],this.Hr=p[1],this.Vr=l,this.Fe.addSettingsChangeListener(this.logger.settingsChangeHandler),this.clientDiagnostics=Object(g.b)(),this.pageStateObserver=new j.a(this.logger,!0),this.authTokenTrustValidator=new S.a(this.logger)}return Object.defineProperty(t.prototype,"diagnostics",{get:function(){return{hostInitDiagnostics:this.hostInitDiagnostics,appInitDiagnostics:this.appInitDiagnostics}},enumerable:!1,configurable:!0}),t.prototype.raiseEvent=function(t,e){this.logger.ULS.Rn(574654541,r.a.Z,s.a.Info,"Raising event: ".concat(t));try{this.Vr(t,e)}catch(t){this.logger.ULS.Rn(593506838,r.a.Z,s.a.Error,"Event handler error: ".concat(Object(O.b)(t)))}},t.prototype.addActionHandler=function(t,e){this.Mr[t]||(this.Mr[t]=[]),this.Mr[t].push(e)},t.prototype.removeActionHandler=function(t,e){var n=this.Mr[t];if(n&&n.length>0){var i=n.indexOf(e);i>-1&&n.splice(i,1)}},t.prototype.run=function(t,e,n){var i=this,o=[],c=this.Mr[t];if(c&&c.length>0)o.push(this.kr(t,e));else{var a=m[t];if(a){var u=a.Ur,f=a.Er;if(u){this.logger.ULS.Rn(574654542,r.a.Z,s.a.Info,"Running flow: ".concat(u));var d=this.Dr[u](t,e,this,this.Hr[u],n).catch((function(t){return i.Jr(u,t),{completion:"failure",error:t}}));o.push(d)}else f&&(this.container&&this.container.postMessage(f,e),o.push(Promise.resolve({completion:"success"})))}else o.push(Promise.resolve({completion:"failure"})),this.logger.ULS.Rn(593500189,r.a.Z,s.a.Warning,"Unhandled command: ".concat(t))}return Promise.race(o)},t.prototype.dispose=function(){if(this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.Fe.dispose(),this.pageStateObserver.dispose(),this.authTokenTrustValidator.dispose(),this.Mr={},!this.pendingReboot){var t=this.application.sessions,e=t.indexOf(this.session);e>-1&&t.splice(e,1)}},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var i=n(3),o=n(9),r=n(17),s=n(0),c=n(1),a=n(35),u=n(2),f=n(13),d=function(t){function e(e,n,i,r,s){var c=t.call(this,e,n,i,r,s)||this;return c.zr=function(t){var e={errorType:t.errorType,errorObject:t.errorObject};if(!e.errorType||!e.errorObject)throw new TypeError("Error object is missing errorType or errorObject");c.Lr&&c.Lr(e)},c.qr=function(t){c.Zo=t.newLevel,c.ii(u.a.ZoomChanged,t)},c.Gr=function(t){c.Kr=t.newPage,c.ii(u.a.PageChanged,t)},c.Zr=function(t){c.$r=t.isDisabled,c.ii(u.a.IsDisabled,t)},c.ci=s.innerApplicationFrame,c.Kn=i,c.oi=n,c.qn={},c.Lo=s.isCore,c.Kr=s.currentPage,c.Zo=s.zoomLevel,c.Ko=s.pageCount,c.$r=!c.Lo,c.Kn.registerMessagePayloadHandler(o.a.Te,c.qr),c.Kn.registerMessagePayloadHandler(o.a.ee,c.Gr),c.Kn.registerMessagePayloadHandler(o.a.Jt,c.Zr),c.Kn.registerMessagePayloadHandler(o.a.Nt,c.zr),c}return Object(i.c)(e,t),e.prototype.SetCurrentPage=function(t){var e=this;this.$r?this.zr({errorType:f.a.ApiDisabledError,errorObject:{isCoreMode:this.Lo}}):(this.Xr=t,this.Kn.sendPostMessage(this.ci,r.a.On,{newPage:this.Xr}),window.setTimeout((function(){e.Xr!==e.Kr&&e.oi.ULS.Rn(596444179,s.a.N,c.a.Info,'Did not receive the page change update. {"RequestedPage": '+e.Xr+', "CurrentPage": '+e.Kr+"}")}),5e3))},e.prototype.GetPageCount=function(){return this.$r&&this.zr({errorType:f.a.ApiDisabledError,errorObject:{isCoreMode:this.Lo}}),this.Ko},e.prototype.GetCurrentPage=function(){return this.$r&&this.zr({errorType:f.a.ApiDisabledError,errorObject:{isCoreMode:this.Lo}}),this.Kr},e.prototype.SetZoomLevel=function(t){var e=this;this.$r?this.zr({errorType:f.a.ApiDisabledError,errorObject:{isCoreMode:this.Lo}}):(this.Qr=Number(t.toFixed(2)),this.Kn.sendPostMessage(this.ci,r.a.wn,{newLevel:this.Qr}),window.setTimeout((function(){e.Qr!==e.Zo&&e.oi.ULS.Rn(596444180,s.a.N,c.a.Info,'Did not receive the zoom change update. {"RequestedZoom": '+e.Qr+', "CurrentZoom": '+e.Zo+"}")}),5e3))},e.prototype.GetZoomLevel=function(){return this.$r&&this.zr({errorType:f.a.ApiDisabledError,errorObject:{isCoreMode:this.Lo}}),this.Zo},e.prototype.GetIsDisabled=function(){return this.$r},e.prototype.GetApplicationType=function(){return"Word Viewer"},e.prototype.RegisterEventHandler=function(t,e){switch(t){case u.a.ZoomChanged:case u.a.PageChanged:case u.a.IsDisabled:if(this.qn[t])throw new Error("Duplicate registration");this.qn[t]=e;break;default:this.Kn.registerMessagePayloadHandler(t,e)}},e.prototype.RemoveEventHandler=function(t,e){switch(t){case u.a.ZoomChanged:case u.a.PageChanged:case u.a.IsDisabled:if(this.qn[t]!==e)throw new Error("The handler requested to be removed does not exist for the eventType");delete this.qn[t];break;default:this.Kn.removeMessageHandler(t)}},e.prototype.RegisterErrorHandler=function(t){this.Lr=t},e.prototype.RemoveErrorHandler=function(t){if(this.Lr!==t)throw new Error("The handler requested to be removed does not exist");delete this.Lr},e}(a.a);function h(t,e,n,i,o){return new d(t,e,n,i,o)}},function(t,e,n){"use strict";var i=n(110),o=n(3),r=n(9),s=n(43),c=n(0),a=n(1),u=function(t,e,n,i,u){return t!==r.a.oe?Promise.reject("Wrong flow"):new Promise((function(t){n.pendingReboot=!0;var i=void 0;if(e.queryOverrides)try{i=JSON.parse(e.queryOverrides)}catch(t){n.logger.ULS.Rn(592217694,c.a.Z,a.a.Error,"Failed to parse queryOverrides: ".concat(i))}n.raiseEvent(s.a.Reboot,Object(o.a)(Object(o.a)({},e),{previousSessionId:n.sessionId,queryOverrides:i})),t({completion:"success"})}))},f=n(37),d=n(17),h=n(44),l=n(113);var p=n(32),v=n(87),m=n(21),b=n(52),O=n(89),w=n(7),g=n(15),j=n(8);function S(t){return function(t,e){var n={};e&&Object.keys(e).forEach((function(t){n[t.toLowerCase()]=e[t]}));return t.split("&").forEach((function(t){if(/^wd\w+=\w+/i.test(t)){var e=t.split("=");n[e[0].toLowerCase()]=e[1]}})),n}(window.location.search.substring(1),t)}function I(t,e,n){var i=Object(o.a)(Object(o.a)(Object(o.a)({},Object(w.r)(t.appUrl)),function(t){var e={};Object(w.a)(e,"jsapi","1"),Object(w.a)(e,"jsapiver","v2"),Object(w.a)(e,"corrid",t.sessionId),Object(w.a)(e,"usid",t.sessionId),Object(w.a)(e,"newsession","1"),Object(w.a)(e,"sftc","1"),t.hostSessionId&&Object(w.a)(e,"hid",encodeURIComponent(t.hostSessionId));var n=t.host;n.uiHostName&&Object(w.a)(e,"uih",n.uiHostName),n.uiHostIntegrationType&&Object(w.a)(e,"uihit",encodeURIComponent(n.uiHostIntegrationType)),n.metaUiHostVersion&&Object(w.a)(e,"muv",encodeURIComponent(n.metaUiHostVersion));var i=n.capabilities;i&&(i.accessibilityLoop&&Object(w.a)(e,"accloop","1"),i.rebootDoc&&Object(w.a)(e,"sdr",i.rebootDoc.toString()),i.createNewDoc&&Object(w.a)(e,"scnd","1"),i.authToken&&Object(w.a)(e,"sat","1"),i.customAuthConfig&&Object(w.a)(e,"cac","1"),i.refreshAccessToken&&Object(w.a)(e,"rat","1"),i.atMentions&&Object(w.a)(e,"sams","1"),i.moveToFolder&&Object(w.a)(e,"mtf","1"),i.noBrowserModalDialogs&&Object(w.a)(e,"nbmd","1"),i.commonFilePicker&&Object(w.a)(e,"sfp","1"));var o=t.ui;o.language&&Object(w.a)(e,"ui",encodeURIComponent(o.language)),o.uiEmbed&&Object(w.a)(e,"uiembed","1"),o.hideHeader&&Object(w.a)(e,"hhdr","1"),o.highContrast&&Object(w.a)(e,"hcm",encodeURIComponent(o.highContrast)),o.hideFileLocationPicker&&Object(w.a)(e,"hodflp","1"),o.hideAppLauncherInHeader&&Object(w.a)(e,"halh","1"),o.hideChatInHeader&&Object(w.a)(e,"hch","1"),o.hideMeInHeader&&Object(w.a)(e,"hmh","1"),o.hideSearchInHeader&&Object(w.a)(e,"hsh","1"),o.hideWorkflowInHeader&&Object(w.a)(e,"hwfh","1"),o.hideSettingsInHeader&&Object(w.a)(e,"hsth","1"),o.showAppIconInHeader&&Object(w.a)(e,"sih","1"),o.useNeutralColorInHeader&&Object(w.a)(e,"unh","1"),o.openLinksInNewWindow&&Object(w.a)(e,"onw","1"),o.useDarkTheme&&Object(w.a)(e,"udt","1"),"DocGen"===o.contentAssemblyMode&&Object(w.a)(e,"readOnly","1");var r=t.wopi;r&&r.source&&Object(w.a)(e,"wopisrc",encodeURIComponent(r.source));var s=t.bootParams;s&&(s.dataLanguage&&Object(w.a)(e,"rs",encodeURIComponent(s.dataLanguage)),s.readOnly&&Object(w.a)(e,"readonly","1"),s.disableChat&&Object(w.a)(e,"dchat","1"),s.cookieCompliant&&Object(w.a)(e,"mscc","1"),s.isNewFile&&(Object(w.a)(e,"new","1"),s.isFromHostTemplate&&Object(w.a)(e,"wdtpl","fromhost"))),t.user.isLicensed&&Object(w.a)(e,"islicenseduser","1"),t.actNavId&&Object(w.a)(e,"actnavid",t.actNavId),t.sessionContext&&Object(w.a)(e,"sc",encodeURIComponent(t.sessionContext));var c=t.wdParams;if(c)for(var a in c)Object(w.a)(e,a,c[a]);var u=t.preseededSession;u&&(u.key&&Object(w.a)(e,"preseededsessionkey",encodeURIComponent(u.key)),u.id&&Object(w.a)(e,"preseededwacsessionid",encodeURIComponent(u.id)));var f=t.throttling;f&&(f.protection&&Object(w.a)(e,"ctp",f.protection),f.request&&Object(w.a)(e,"rct",f.request));var d=t.hostInitDiagnostics;d&&(d.entryPoint&&Object(w.a)(e,"wdorigin",encodeURI(d.entryPoint)),d.userClickTime&&Object(w.a)(e,"wdhostclicktime",d.userClickTime.toString()));var h=t.rebootOverride;return h&&h.previousSessionId&&Object(w.a)(e,"wdprevioussession",h.previousSessionId),Object(w.q)(e,"region"),e}(t)),n),r=t.rebootOverride;return r&&r.queryOverrides&&(i=Object(o.a)(Object(o.a)({},i),r.queryOverrides)),Object(w.d)(t.appBasePath,e,i)}function y(t,e){var n=function(t){var e={};Object(w.a)(e,"highdpi",String(window.devicePixelRatio>1.24)),Object(w.a)(e,"softblockedbrowser",String(Object(g.f)())),Object(w.a)(e,"hostname",t.hostName),Object(w.a)(e,"feature_status",Object(b.b)(t.featureManager,t.wdParams));var n=t.wopi;n&&(Object(w.a)(e,"access_token",n.accessToken),Object(w.a)(e,"access_token_ttl",n.expiry.toString()));var i=t.customFontCatalogUrl;i&&Object(w.a)(e,"customfontcatalogurl",i);var o=t.contentBundle;if(o&&o.url){Object(w.a)(e,"bundlesrc",o.url);var r=o.staleness,s=null!=r;s&&Object(w.a)(e,O.a.Mi,r.toString()),t.logger.ULS.Rn(577783775,c.a.Z,a.a.Info,"Content bundle staleness: "+(s?r:"N/A"))}var u=t.file,f=u.name;if(f){Object(w.a)(e,"filename",f);var d=Object(j.a)(f);d&&Object(w.a)(e,"fileextension",d)}u.getUrl&&Object(w.a)(e,"filegeturl",u.getUrl),u.size&&Object(w.a)(e,"filesize",u.size.toString()),u.eTag&&Object(w.a)(e,"etag",u.eTag),u.cTag&&Object(w.a)(e,"revid",u.cTag),u.uniqueId&&Object(w.a)(e,"docid",u.uniqueId);var h=t.newFileTemplate;h&&(h.getUrl&&Object(w.a)(e,"templateurl",h.getUrl),h.size&&Object(w.a)(e,"filesize",h.size.toString()),h.eTag&&Object(w.a)(e,"etag",h.eTag),h.uniqueId&&Object(w.a)(e,"docid",h.uniqueId)),t.user.id&&Object(w.a)(e,"user_id",t.user.id),t.ownerId&&Object(w.a)(e,"owner_id",t.ownerId),t.sessionContext&&Object(w.a)(e,"sc",t.sessionContext);var l=t.ui;l.controls&&Object(w.a)(e,"huictrls",JSON.stringify(l.controls)),l.contentAssembly&&Object(w.a)(e,"caae","1"),"Templatization"!==l.contentAssemblyMode&&"DocGen"!==l.contentAssemblyMode||Object(w.a)(e,"caae","1");var p=t.meeting;return p&&(p.id&&Object(w.a)(e,"meetingId",p.id),p.title&&Object(w.a)(e,"meetingTitle",p.title),p.type&&Object(w.a)(e,"meetingType",p.type),p.scheduledStartTime&&Object(w.a)(e,"scheduledStartTime",p.scheduledStartTime),p.scheduledEndTime&&Object(w.a)(e,"scheduledEndTime",p.scheduledEndTime),p.isPresenter&&Object(w.a)(e,"isPresenter",p.isPresenter.toString()),p.organizerId&&Object(w.a)(e,"meetingOrganizerId",p.organizerId),p.joinUrl&&Object(w.a)(e,"meetingJoinUrl",encodeURIComponent(p.joinUrl))),e}(t);return Object.keys(e).forEach((function(t){e[t]?n[t]=e[t]:delete n[t]})),n}var T=n(11),_=n(88),C=n(53),P=n(54),R=n(51),A=n(19),U=n(90),E=function(t,e,n,i,s){return t!==f.a.boot?Promise.reject("Wrong flow"):new Promise((function(t){var u,f=Object(T.a)();if(n.state=p.a.Booting,n.pendingReboot=!1,function(t,e){if(!t)throw new TypeError("SessionBootParams");var n=t.appUrl,i=t.appBaseUrl;if(!n&&!i)throw new TypeError("Either appUrl or appBaseUrl should exist");if(n&&"string"!=typeof n)throw new TypeError("AppUrl");if(i&&"string"!=typeof i)throw new TypeError("AppBaseUrl");var o=t.file;if(!o||!o.name)throw new TypeError("FileInfo");var r=t.container;if(!r||!(r instanceof l.a)&&!r.appendChild)throw new TypeError("Container");if(!e&&!Object(h.a)(t.wopi))throw new TypeError("WopiInfo")}(e,n.skipWopiValidation),n.intent=e.intent,n.file=e.file,n.customFontCatalogUrl=e.customFontCatalogUrl,n.wopi=e.wopi,n.contentBundle=e.contentBundle,n.newFileTemplate=e.newFileTemplate,n.ownerId=e.ownerId,n.sessionContext=e.sessionContext,n.actNavId=e.actNavId,n.preseededSession=e.preseededSession,n.throttling=e.throttling,n.hostInitDiagnostics=Object(o.a)(Object(o.a)({},e.diagnostics),{hostInitializeCallTime:f}),n.meeting=e.meeting,n.wdParams=S(e.wdParams),n.rebootOverride=e.rebootOverride,n.bootParams=e.bootParams||{},e.appUrl){var b=e.appUrl;n.appUrl=b;var O=n.bootParams;if(Object(w.p)(b,"new")&&(O.isNewFile=!0),!O.dataLanguage)(g=Object(w.l)(b,"rs"))&&(O.dataLanguage=g);var g,E=n.ui;if(Object(w.p)(b,"uiembed")&&(E.uiEmbed=!0),!E.language)(g=Object(w.l)(b,"ui"))&&(E.language=g);if(!n.hostInitDiagnostics.entryPoint){var W=Object(w.l)(b,"wdorigin");W&&(n.hostInitDiagnostics.entryPoint=W)}if(!n.host.uiHostName){var F=Object(w.l)(b,"uih");F&&(n.host.uiHostName=F)}}else n.appUrl="";n.appBaseUrl=e.appBaseUrl?e.appBaseUrl.toLowerCase():Object(w.i)(e.appUrl).toLowerCase(),n.appBaseUrl=Object(w.u)(n.appBaseUrl,Object(w.k)(n.appUrl,"region")),i.initializeAppContext(n,t),n.appBasePath=i.buildAppBasePath(n),n.remoteTelemetryUrl=i.buildRemoteTelemetryUrl(n),Object(v.a)(n.remoteTelemetryUrl,n.appInfo.name,"init");var N=!1,x=n.preseededSession;n.appInfo.usePreseededSessionId&&x&&x.id&&(n.sessionId=x.id,N=!0);var M,k=!1,D=e.hostGeneratedSessionId;if(!N&&D&&(n.sessionId=D,k=!0),e.rebootOverride&&(N||k||(u=Object(_.a)(),n.sessionId=u[0],M=u[1]),n.Fe.addSettingsChangeListener(n.logger.settingsChangeHandler),n.pageStateObserver=new C.a(n.logger,!0),n.authTokenTrustValidator=new P.a(n.logger)),n.logger.ULS.Rn(38580693,c.a.Z,a.a.Info,"User session id: ".concat(n.sessionId,", is preseeded: ").concat(N,", is host generated: ").concat(k)),n.logger.configure({remoteUlsEndpoint:Object(w.f)(n.appBasePath),sessionId:n.sessionId}),n.Fe.initializePeriodicFetch(n.appBasePath,n.sessionId),M&&n.logger.ULS.Rn(590966790,c.a.Z,a.a.Info,JSON.stringify(M)),Object(R.f)(n),n.appInitDiagnostics={officeSessionId:n.sessionId,officeBootstrapperVersion:Object(A.a)(),hostName:n.hostName,documentLoadedWithTabSwitch:"hidden"===document.visibilityState},document.addEventListener("visibilitychange",(function(){n.appInitDiagnostics.documentLoadedWithTabSwitch=!0}),{once:!0}),!n.container){var H=e.container;n.container=H instanceof l.a?H:n.application.createContainer(H)}n.container.setMessageHandler(n.onMessage);var J=!!i.ignoreCompletionMessage&&i.ignoreCompletionMessage(n),B=function(t,e){n.successTime=Object(T.a)(),J||(n.container.postMessage(d.a.Qe,void 0),Object(R.a)(n.appInitDiagnostics,e.Diagnostics)),i.onSuccess&&i.onSuccess(n),n.logger.ULS.Rn(596448985,c.a.Z,a.a.Info,JSON.stringify(n.diagnostics)),Object(v.a)(n.remoteTelemetryUrl,n.application.name,"bootSuccess"),n.logger.ULS.flush(),n.container.postMessage(d.a.rn,{HostInitializeDiagnostics:n.hostInitDiagnostics,ClientDiagnostics:n.clientDiagnostics}),n.state=p.a.Booted,z({completion:"success"}),Object(R.g)(n.appInfo.name,n.logger)},V=function(t,e){n.failureTime=Object(T.a)(),i.onFailure&&i.onFailure(n,e.Error),n.logger.ULS.Rn(596448986,c.a.Z,a.a.Error,JSON.stringify({error:e.Error,diagnostics:n.diagnostics})),Object(v.a)(n.remoteTelemetryUrl,n.application.name,"bootFailure"),n.logger.ULS.flush(),n.state=p.a.Failed,z({completion:"failure"}),Object(R.g)(n.appInfo.name,n.logger)},z=function(e){J||(n.bootHeartBeat&&n.bootHeartBeat.stop(),n.removeActionHandler(r.a.Tt,B),n.removeActionHandler(r.a.It,V)),t(e)};s&&s.subscribe((function(){z({completion:"cancelled"})})),J||(n.addActionHandler(r.a.Tt,B),n.addActionHandler(r.a.It,V));var L=i.buildBootRequestParams(n),q=I(n,L.appPageName,L.queryParamsOverrides),G=y(n,L.postDataOverrides);if(n.bootstrapperUrl&&n.preconnector&&n.preconnector.shouldPreconnect(n.hostName)&&n.preconnector.preconnect(n.bootstrapperUrl),n.bootstrapperUrl&&n.preloader&&n.preloader.shouldPreload(q))try{i.beforePreload&&i.beforePreload(n);var K=n.bootstrapperUrl;n.featureManager.isFeatureEnabled(m.a.Fn)&&(n.logger.ULS.Rn(590966791,c.a.Z,a.a.Info,"HTTP2 preload enabled"),K=Object(w.v)(K)),n.preloader.preload(K,n.ui.language,n.logger,n.featureManager)}catch(t){n.logger.ULS.Rn(590966792,c.a.Z,a.a.Error,Object(j.b)(t))}i.beforeContainerBoot&&i.beforeContainerBoot(n,q);var Z=i.buildPermissionsPolicy?i.buildPermissionsPolicy(n):"microphone ".concat(n.appBaseUrl,"; autoplay ").concat(n.appBaseUrl,"; camera ").concat(n.appBaseUrl,"; clipboard-read ").concat(n.appBaseUrl,"; clipboard-write ").concat(n.appBaseUrl,"; keyboard-map ").concat(n.appBaseUrl);n.appInitDiagnostics.officeFrameCreateTime=Object(T.a)(),n.container.boot(q,G,n.logger,Z,{useAdditionalDiv:n.useAdditionalDiv,minHeight:n.minHeight,minWidth:n.minWidth}),J?B(r.a.Tt,{Diagnostics:{}}):n.bootHeartBeat=new U.a(Object(w.n)(n.appBaseUrl),n.Fe,n.logger,(function(){n.timeoutTime=Object(T.a)(),i.onTimeout&&i.onTimeout(n),Object(v.a)(n.remoteTelemetryUrl,n.application.name,"bootTimeout"),s?s.cancel():z({completion:"cancelled"})}),s?s.Ar:i.overrideBootTimeout?i.overrideBootTimeout(n):void 0)})).catch((function(t){throw n.failureTime=Object(T.a)(),i.onException&&i.onException(n,t),n.remoteTelemetryUrl&&Object(v.a)(n.remoteTelemetryUrl,n.application.name,"bootException"),t}))},W=function(t,e,n){return new Promise((function(e){n.logger.ULS.Rn(590111070,c.a.Z,a.a.Error,"Unsupported flow: ".concat(t)),e({completion:"failure"})}))},F=n(94),N=function(t,e,n,i,s){return t!==f.a.createNew?Promise.reject("Wrong flow"):new Promise((function(u){var l={wopiPendingInitializeTime:Object(T.a)()},v=!!(i&&i.parallelizeStartSessionRequest&&i.buildStartSessionRequestParams)&&i.parallelizeStartSessionRequest(n),m=!1,b=!1,O=!1,w=!1,j=void 0,S=void 0,y=!1,_=!1;if(Object(g.e)())!function(){n.logger.ULS.Rn(578074079,c.a.Z,a.a.Info,"Waiting for WOPI info to start boot");var t=function(t,r){if(m)n.logger.ULS.Rn(578074080,c.a.Z,a.a.Warning,"completeCreateNew already called");else{if(m=!0,l.wopiPendingCompleteTime=Object(T.a)(),"failure"===r.state)return J(r.reason),n.state=p.a.Failed,void i({completion:"failure"});x(r.newFile),n.run(f.a.boot,Object(o.a)(Object(o.a)({},e),{wopi:r.wopi}),s).then((function(t){i(t)}))}};n.addActionHandler(f.a.completeCreateNew,t);var i=function(e){n.removeActionHandler(f.a.completeCreateNew,t),u(e)};s&&s.subscribe((function(){i({completion:"cancelled"})}))}();else{var C=function(t,e){m?n.logger.ULS.Rn(587236372,c.a.Z,a.a.Warning,"completeCreateNew already called"):(m=!0,l.wopiPendingCompleteTime=Object(T.a)(),"failure"!==e.state?(j=e.wopi,Object(h.a)(j)?(n.wopi=j,n.logger.ULS.Rn(587286030,c.a.Z,a.a.Info,"WOPI info received. Access token: "+JSON.stringify({length:j.accessToken.length,expiry:j.expiry})+", current state: "+JSON.stringify({parallelizeStartSessionRequest:v,wacFrameLoaded:b,wacCanAcceptStartSessionResponse:O})),!v||b&&!O?b&&N():A(),b&&n.container&&n.container.postMessage(d.a.Sn,void 0),x(e.newFile)):P("InvalidWopiInfo")):P(e.reason))},P=function(t){J(t),b&&n.container&&n.container.postMessage(d.a.gn,void 0)},A=function(){n.logger.ULS.Rn(587233056,c.a.Z,a.a.Info,"Making parallelized StartSession request");var e=i.buildStartSessionRequestParams(n,t,j),o=I(n,e.appPageName,e.queryParamsOverrides),r={"Content-Type":"application/x-www-form-urlencoded"},s="access_token="+encodeURIComponent(j.accessToken)+"&access_token_ttl="+encodeURIComponent(j.expiry.toString());l.startSessionStartTime=Object(T.a)(),Object(F.a)(o,s,r,U)},U=function(t){var e=Object(T.a)();l.startSessionCompleteTime=e,n.logger.ULS.Rn(587233057,c.a.Z,a.a.Info,"StartSession request completed. Status code: ".concat(t.status,", time: ").concat(e)),S={RequestStatus:t.status,ResponseText:t.responseText},b&&O?W():n.logger.ULS.Rn(587233058,c.a.Z,a.a.Info,"StartSession response not yet sent: "+JSON.stringify({wacFrameLoaded:b,wacCanAcceptStartSessionResponse:O,wopiInfoSent:y,startSessionResponseSent:_}))},E=function(t,e){l.readyMessageReceiveTime=Object(T.a)(),n.container&&n.container.postMessage(d.a.Ke,void 0),b||(b=!0,O=e.CanAcceptStartSessionComplete,n.logger.ULS.Rn(587321567,c.a.Z,a.a.Info,"App ready: "+JSON.stringify({parallelizeStartSessionRequest:v,wacCanAcceptStartSessionResponse:O,startSessionResponseAvailable:!!S,wopiInfoAvailable:!!j})),m&&n.container&&n.container.postMessage(j?d.a.Sn:d.a.gn,void 0),v&&O?W():N(),Object(R.a)(n.appInitDiagnostics,e.Diagnostics))},W=function(){_||y||!S||(200===S.RequestStatus?(_=!0,l.completeMessageCreateTime=Object(T.a)(),M(d.a.Ye,{StartSessionResponse:S,Diagnostics:l},3)):N())},N=function(){_||y||!j||(y=!0,l.completeMessageCreateTime=Object(T.a)(),i&&i.sendCreateNewWopiInfo?i.sendCreateNewWopiInfo(n):M(d.a.tn,{WopiDetails:{WopiSrc:j.source,AccessToken:j.accessToken,AccessTokenTtl:j.expiry.toString()},Diagnostics:l},3))},M=function(t,e,i){var o=Object(T.a)();i<=0?n.logger.ULS.Rn(587233165,c.a.Z,a.a.Error,"Attempted to complete but no ack. Time: ".concat(o)):(n.logger.ULS.Rn(587233166,c.a.Z,a.a.Info,"Sending complete message. Retries left: ".concat(i-1,", Time: ").concat(o)),l.completeMessageSendTime=o,n.container&&n.container.postMessage(t,e),window.setTimeout(k,1e3,t,e,i-1))},k=function(t,e,i){w||(n.logger.ULS.Rn(587233167,c.a.Z,a.a.Info,"Timeout session complete ack. Retries left: ".concat(i)),M(t,e,i))},D=function(t,e){w=!0},H=function(t){n.removeActionHandler(f.a.completeCreateNew,C),n.removeActionHandler(r.a.St,E),n.removeActionHandler(r.a.de,D),u(t)};n.addActionHandler(f.a.completeCreateNew,C),n.addActionHandler(r.a.St,E),n.addActionHandler(r.a.de,D),s&&s.subscribe((function(){H({completion:"cancelled"})})),n.skipWopiValidation=!0,n.wopi=void 0,n.run(f.a.boot,e,s).then((function(t){n.skipWopiValidation=!1,n.wopi=j,H(t)}))}function J(t){n.logger.ULS.Rn(596444188,c.a.Z,a.a.Warning,"Fail with reason: "+(t?JSON.stringify(t):"N/A"))}}))};function x(t){t&&(t.path&&history.replaceState({},"",t.path),t.title&&(document.title=t.title))}var M=n(42),k=function(t,e,n,i,o){return t!==f.a.dispose?Promise.reject("Wrong flow"):new Promise((function(t){var e=n.host.requireExplicitUnload,i={disposeStartTime:Object(T.a)(),forceAppUnload:e};n.state=p.a.Disposing;var s=function(){n.state=p.a.Disposed,t({completion:"success"})},u=function(t){n.dispose(),i.disposeEndTime=Object(T.a)(),function(t,e,n){if(n){var i=Number(n.hostMessageReceived);e.appUnloadStartTime&&!isNaN(i)&&(e.hostToAppPostMessageLatency=i-e.appUnloadStartTime);var o=Number(n.appMessageSent);!isNaN(o)&&e.appUnloadEndTime&&(e.appToHostPostMessageLatency=e.appUnloadEndTime-o);var r=Number(n.appUnloadStart),s=Number(n.appUnloadEnd);if(isNaN(r)||isNaN(s)||(e.appUnloadLatency=s-r),n.serverTimings){var u=n.serverTimings;for(var f in u)e["st-"+f.toString()]=u[f]}}t.logger.ULS.Rn(592524822,c.a.Z,a.a.Info,"App disposed: "+JSON.stringify(e)),t.logger.ULS.flushOnClose()}(n,i,t),n.container?n.container.dispose(n.pendingReboot,e).then(s):s()};if(e){i.appUnloadStartTime=Object(T.a)();n.addActionHandler(r.a.be,(function(t,e){i.appUnloadEndTime=Object(T.a)(),u(e)})),(o||new M.a(5e3)).subscribe((function(){n.state===p.a.Disposing&&(i.appUnloadTimedOut=!0,u())})),n.container&&n.container.postMessage(d.a.yn,void 0)}else u()}))};var D=function(t,e,n,i,o){return t!==r.a.Bt?Promise.reject("Wrong flow"):new Promise((function(t){var e=!!n.container&&n.container.isTopFrameTrusted;n.logger.ULS.Rn(592445957,c.a.Z,a.a.Info,"Top frame is trusted: ".concat(e)),n.container&&n.container.postMessage(d.a.Bt,{isTopFrameTrusted:e}),t({completion:"success"})}))},H=function(t,e,n,i,o){return t!==r.a.zt?Promise.reject("Wrong flow"):new Promise((function(t){n.authTokenTrustValidator.isResourceTrustedForMessage(e).then((function(i){i?J(n,e,t):(n.container.postMessage(d.a.fn,{AuthToken:"",Error:"accessDenied",RequestId:e.RequestId,IdentityType:e.IdentityType}),t({completion:"success"}))}),(function(i){n.container.postMessage(d.a.fn,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:e.RequestId,IdentityType:e.IdentityType}),t({completion:"failure",error:i})}))}))},J=function(t,e,n){var i=function(e,n){t.container.postMessage(d.a.fn,n);var i={completion:!n.AuthToken||n.Error?"failure":"success"};n.Error&&(i.error=n.Error),o(i)},o=function(e){t.removeActionHandler(f.a.sendAuthToken,i),n(e)};t.addActionHandler(f.a.sendAuthToken,i),t.raiseEvent(s.a.GetAuthToken,e)},B=n(92),V=function(t,e,n,i,o){return t!==r.a.yt?Promise.reject("Wrong flow"):new Promise((function(t){var o=e&&e.state?e.state:"Unknown";n.logger.ULS.Rn(592839750,c.a.Z,a.a.Info,"Boot state: [".concat(o,"]")),i&&i.beforeComplete&&i.beforeComplete(o),t({completion:"success"})}))},z=function(t,e,n,i,o){return t!==f.a.rename?Promise.reject("Wrong flow"):new Promise((function(t){var i=function(t,n){var i={completion:n.NewName===e.NewName?"success":"failure"};c(i)},s=function(t,e){c({completion:"failure"})},c=function(e){n.removeActionHandler(r.a.kt,i),n.removeActionHandler(r.a.Dt,s),t(e)};n.addActionHandler(r.a.kt,i),n.addActionHandler(r.a.Dt,s),(o||new M.a(5e3)).subscribe((function(){c({completion:"cancelled"})})),n.container&&n.container.postMessage(d.a.an,e)}))},L=n(91),q=n(93),G=function(t,e,n,i,o){return t!==f.a.switchMode?Promise.reject("Wrong flow"):new Promise((function(t){var i=function(t,e){s({completion:"success"})},s=function(e){n.removeActionHandler(r.a.$t,i),t(e)};n.addActionHandler(r.a.$t,i),(o||new M.a(5e3)).subscribe((function(){s({completion:"cancelled"})})),n.container&&n.container.postMessage(d.a.In,e)}))};function K(t){var e=t.appContext;e.canSupportConsumption=!1,e.isUnifiedRead=!1}var Z=n(16),$=n(27),X=n(4),Q=n(28);function Y(t){var e=t.appBaseUrl.indexOf(X.h)>-1,n=t.rebootOverride;if(n){var i=n.mode;i&&("view"===(i=i.toLowerCase())&&e?t.appBaseUrl=Object(X.c)(t.appBaseUrl):"edit"!==i||e||(t.appBaseUrl=Object(X.d)(t.appBaseUrl)))}else{var o=!(!t.ui||!t.ui.uiEmbed),r=o&&!(!t.bootParams||!t.bootParams.readOnly),u=Object(w.p)(t.appUrl,"embed"),f=t.Fe.getValue(Z.a.Le,!1)&&t.featureManager.isFeatureEnabled(m.a.Vn)&&!u&&(t.bootParams&&t.bootParams.isNewFile&&!t.wopi||t.file&&"docx"===Object(j.a)(t.file.name))&&Object(R.d)(t.host.storageHostName)&&!o&&!(t.wdParams&&"1"===t.wdParams.wdembedfs);t.appContext.canSupportConsumption=f,!f||e||Object($.a)(Q.a.Ln,!1)||Object(R.e)(t.throttling?t.throttling.request:void 0,t.Fe.getValue(Z.a.qe,"Major"))?(e&&!r||t.raiseEvent(s.a.ModeSwitched,{NewMode:"view"}),e&&r&&(t.appBaseUrl=Object(X.c)(t.appBaseUrl))):(t.appBaseUrl=Object(X.d)(t.appBaseUrl),t.appContext.isUnifiedRead=!0,t.logger.ULS.Rn(559285716,c.a.Z,a.a.Info,"Redirecting Viewer request to unified read"))}return e=t.appBaseUrl.indexOf(X.h)>-1,t.appBaseUrl+(e?X.e:X.i)}function tt(t){var e=t.appBaseUrl,n=t.appBasePath.indexOf(X.h)>-1,i=Object(g.c)()===g.a.Firefox&&"OneDrive"===t.hostName&&"https://onedrive.live.com.office.prod.zensar.myshn.net"===window.location.origin.toLowerCase();return n&&i&&(e+=" "+window.location.origin),"microphone ".concat(e,"; autoplay ").concat(t.appBaseUrl,"; camera ").concat(t.appBaseUrl,"; clipboard-read ").concat(t.appBaseUrl,"; clipboard-write ").concat(t.appBaseUrl,"; keyboard-map ").concat(t.appBaseUrl)}function et(t){return Object(w.e)(t.appBasePath)}function nt(t){return t.appBasePath.indexOf(X.h)>-1&&!!(t.wopi&&t.bootParams&&t.bootParams.isNewFile)}function it(t,e,n){var i=t.appBasePath.indexOf(X.h)>-1,o=i?e===f.a.createNew?X.g:X.f:X.j,r={},s=t.viewMode;s&&(s.hideToolbar&&Object(w.a)(r,i?"hvt":"core","1"),s.hideBreadCrumb&&Object(w.a)(r,"hbcv","1"),s.hideTitle&&Object(w.a)(r,"htv","1"),s.disableFocusOnBoot&&Object(w.a)(r,"disablefocusonboot","1"),s.forceAccessibilityMode&&!s.hideToolbar&&Object(w.a)(r,"wdaccpdf","1"));var c=t.ui;c&&c.inAppDocPreview&&Object(w.a)(r,"inappdocpreview","1");var a=t.wopi,u=t.bootParams;return i&&(a?u&&u.isNewFile||(t.appContext.canSupportConsumption&&Object(w.a)(r,"csc","1"),t.appContext.isUnifiedRead?(Object(w.a)(r,"cons","1"),Object(w.a)(r,"readonly","1")):Object(w.a)(r,"instantedit","1"),Object(w.a)(r,"wopicomplete","1")):(Object(w.a)(r,"instantedit","1"),Object(w.a)(r,"filesrc",encodeURIComponent(t.hostName)),Object(w.a)(r,"pmorigin",encodeURIComponent(Object(w.i)(window.location.href)))),e===f.a.createNew&&(Object(w.q)(r,"newsession"),Object(w.a)(r,"build",encodeURIComponent(Object(A.a)())),Object(w.a)(r,"wacusertype","WOPI"),t.file.getUrl&&Object(w.a)(r,"filegeturlpresent","1"),n&&Object(w.a)(r,"wopisrc",encodeURIComponent(n.source)))),a&&Object(w.a)(r,"wdredirectionreason",function(t,e,n,i){return t?"Unified_SingleFlush":e?"Unified_IrmEnabled":n&&i?"Unified_UiEmbedReadOnly":"Unified_ViewActionUrl"}(i,!(!u||!u.irmEnabled),!(!c||!c.uiEmbed),!(!u||!u.readOnly))),{appPageName:o,queryParamsOverrides:r,postDataOverrides:{}}}var ot,rt;function st(t){if(ct(),rt){t.container&&t.container.postMessage(d.a.in,{HostCacheLoadTime:rt});var e=t.appInitDiagnostics;e.documentLoadedTime?rt<e.documentLoadedTime?(e.documentLoadedTime=rt,e.documentLoadedFromWopiPrecheckInfo=!0,t.logger.ULS.Rn(577843782,c.a.Z,a.a.Info,"First page loaded from cache was faster")):e.documentLoadedFromWopiPrecheckInfo=!1:e.documentLoadedTime=rt}}function ct(){ot&&ot.parentElement&&ot.parentElement.removeChild(ot)}function at(t,e){!function(t,e){var n={storageHost:t.host.storageHostName||"",uiHost:t.host.uiHostName||Object(w.k)(e,"uih"),wdOrigin:t.hostInitDiagnostics.entryPoint||Object(w.k)(e,"wdorigin")};t.logger.ULS.Rn(561629318,c.a.Z,a.a.Info,JSON.stringify(n))}(t,e),function(t){if(!(t.appBaseUrl.indexOf(X.h)>-1)){t.logger.ULS.Rn(577843778,c.a.Z,a.a.Info,"Boot Word viewer");var e=window.navigator.userAgent;if(!(e.indexOf("Mobi")>=0&&e.indexOf("iPad")<0)){var n=t.rebootOverride;if(!n||!n.reason||"translate"!==n.reason.toLowerCase()){var i=t.viewMode;if(!i||!i.forceAccessibilityMode){var o=t.contentBundle;if(o&&o.url){var r=t.container;if(r){var s=r.element,u=s.ownerDocument;if(u){t.logger.ULS.Rn(577843779,c.a.Z,a.a.Info,"Kick off first page optimization"),(ot=u.createElement("div")).id="FirstPageContainer",ot.style.top=i&&i.hideToolbar?"0":"90px",ot.style.left="0",ot.style.textAlign="center",ot.style.width="1px",ot.style.bottom="0",ot.style.zIndex="900",ot.style.height="1px",ot.style.position="absolute",ot.style.padding="0 29px",ot.style.right="0",ot.style.overflow="auto",ot.style.marginLeft="auto",ot.style.marginRight="auto",ot.style.maxWidth="100%",s.appendChild(ot);var f=u.createElement("img");f.id="FirstPageImage",f.style.marginTop="11px",f.style.marginBottom="11px",f.style.maxWidth="100%",f.style.border="solid 1px #d2d5d8",f.draggable=!1,f.onload=function(){t.logger.ULS.Rn(577843780,c.a.Z,a.a.Info,"First page optimization loaded"),ot.style.width="",ot.style.height="",rt=Object(T.a)()},f.onerror=function(e){ct(),t.logger.ULS.Rn(577843781,c.a.Z,a.a.Warning,"Cannot load first page from cache"),t.appInitDiagnostics.errorObject={errorType:"CannotLoadFirstPage",errorObject:"string"==typeof e?e:e.returnValue}},f.src=o.url.replace("{0}","p1.img"),ot.appendChild(f)}}}}}}}}(t)}function ut(){return!0}n.d(e,"a",(function(){return ft}));var ft=function(){var t,e;return[(t={},t[i.a.appReboot]=u,t[i.a.boot]=E,t[i.a.closeTab]=W,t[i.a.createNew]=N,t[i.a.dispose]=k,t[i.a.frameTrust]=D,t[i.a.getAuthToken]=H,t[i.a.getHostKeyValue]=B.a,t[i.a.handleBootState]=V,t[i.a.rename]=z,t[i.a.setOverlayContent]=L.a,t[i.a.storeHostKeyValue]=q.a,t[i.a.switchMode]=G,t[i.a.updateBootComplete]=W,t),(e={},e[i.a.boot]={initializeAppContext:K,buildAppBasePath:Y,buildPermissionsPolicy:tt,buildRemoteTelemetryUrl:et,ignoreCompletionMessage:nt,buildBootRequestParams:it,beforeContainerBoot:at,onSuccess:st},e[i.a.createNew]={parallelizeStartSessionRequest:ut,buildStartSessionRequestParams:it},e)]}},function(t,e,n){"use strict";function i(t,e,n){if(e){var i=window.navigator;if(i&&i.sendBeacon)try{return void i.sendBeacon(e,t)}catch(t){}!function(t,e,n){var i=new XMLHttpRequest;i.readyState!==XMLHttpRequest.UNSENT&&i.readyState!==XMLHttpRequest.DONE||(i.open("POST",e,n),i.send(t))}(t,e,n)}}n.d(e,"a",(function(){return i}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var i=function(){function t(){this.Yr=[]}return t.prototype.add=function(t){t&&this.Yr.push(t)},t.prototype.remove=function(t){if(t){var e=this.Yr.indexOf(t);e>-1&&this.Yr.splice(e,1)}},t.prototype.removeAll=function(){this.Yr=[]},t.prototype.dispatch=function(t,e){this.Yr.forEach((function(n){try{n(t)}catch(t){e&&e(t)}}))},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var i=n(0),o=n(1),r=n(16),s=n(8),c=n(49),a=n(7),u=n(19),f=function(){function t(t,e){var n=this;this.ts=0,this.es=function(){try{if(!window||!window.localStorage)return;var t=window.localStorage.getItem(n.ns);if(!t)return;var e=JSON.parse(t);n.os(e)}catch(t){n.oi.ULS.Rn(592836768,i.a.Z,o.a.Warning,"Failed to get settings from localStorage: "+Object(s.b)(t))}},this.os=function(t){return!!n.ss(t)&&(n.cs=t,n.as.dispatch({Fe:n},(function(t){n.oi.ULS.Rn(592836769,i.a.Z,o.a.Error,"Settings listener error: "+Object(s.b)(t))})),!0)},this.ss=function(t){if(t&&"object"==typeof t){if(t.hasOwnProperty(r.a.Je)&&!isNaN(t.timestamp))return!0;n.oi.ULS.Rn(592836770,i.a.Z,o.a.Error,"Received invalid settings")}return!1},this.us=function(){if(n.fs){var t=new XMLHttpRequest;t.open("GET",n.fs),t.responseType="json",t.timeout=5e3,t.send(),t.onload=function(){if(200===t.status&&t.response?(n.ds(t.response),n.ts=0):(n.oi.ULS.Rn(592836771,i.a.Z,o.a.Error,"Fetch settings error. Status: ".concat(t.status,", curErrors: ").concat(n.ts)),n.ts+=1),!(n.ts>7)){var e=n.getValue(r.a.He,3e5);n.ts>3&&(e+=(n.ts-3+1)*(e/2)),n.hs=window.setTimeout(n.us,e)}}}},this.ds=function(t){"requestIdleCallback"in window?(n.ls&&self.cancelIdleCallback(n.ls),n.ls=window.requestIdleCallback((function(){return n.ps(t)}),{timeout:1e4})):window.setTimeout((function(){return n.ps(t)}),0)},this.ps=function(t){if(n.os(t)&&window&&window.localStorage){var e=JSON.stringify(t);try{window.localStorage.setItem(n.ns,e)}catch(t){n.oi.ULS.Rn(592836800,i.a.Z,o.a.Warning,"Failed to set localStorage: "+Object(s.b)(t))}}},this.vs=t,this.ns="Prod"+t+"Settings",this.oi=e,this.as=new c.a,this.es()}return t.prototype.initializePeriodicFetch=function(t,e){this.ns=(Object(a.n)(t)?"FF":"Prod")+this.vs+"Settings",this.es(),this.fs=t+a.c+"?app="+this.vs+"&usid="+e+"&build="+Object(u.a)(),this.hs||(this.hs=window.setTimeout(this.us,3e4))},t.prototype.getValue=function(t,e){if(this.cs||this.es(),!this.cs||!this.cs.hasOwnProperty(t))return e;var n=this.cs[t],i=typeof e;if(typeof n===i)return n;if("string"==typeof n){if("number"===i)return parseInt(n,10);if("boolean"===i)return"true"===n}return e},t.prototype.addSettingsChangeListener=function(t){this.as.add(t)},t.prototype.removeSettingsChangeListener=function(t){this.as.remove(t)},t.prototype.dispose=function(){this.hs&&window.clearTimeout(this.hs),this.ls&&self.cancelIdleCallback(this.ls),this.hs=void 0,this.ls=void 0,this.cs=void 0,this.as.removeAll()},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return d})),n.d(e,"g",(function(){return h})),n.d(e,"c",(function(){return p})),n.d(e,"b",(function(){return m})),n.d(e,"f",(function(){return b})),n.d(e,"d",(function(){return w})),n.d(e,"e",(function(){return g}));var i=n(3),o=n(0),r=n(1),s=n(15),c=n(19),a=n(11),u=n(8),f=n(7);function d(t,e){e&&Object.keys(e).forEach((function(n){t[n]=e[n]}))}function h(t,e){try{if(void 0===window.performance)return void e.ULS.Rn(595948609,o.a.Z,r.a.Info,"Performance not supported");var n=window.performance.getEntriesByType("resource");if(void 0===n||n.length<=0)return void e.ULS.Rn(595948610,o.a.Z,r.a.Info,"No resources under performance");for(var i=new RegExp(t+"(-boot.min|(.(app|preview))?.boot).js","i"),s=n.length-1;s>=0;s-=1){var c=n[s],a=c.name.match(i);if(a){var f=JSON.stringify(c);return f=f.replace(new RegExp(c.name,"g"),a[0]),void e.ULS.Rn(595948616,o.a.Z,r.a.Info,f)}}e.ULS.Rn(595948484,o.a.Z,r.a.Info,"Could not find JSAPI resource timing entry")}catch(t){e.ULS.Rn(595948617,o.a.Z,r.a.Info,"Could not trace the resource timing: ".concat(Object(u.b)(t)))}}function l(t){var e,n,o=Object(i.a)(Object(i.a)({},t.host),{sessionId:t.hostSessionId,domain:location?location.host:void 0}),r={};if(t.wdParams){var s=JSON.parse(JSON.stringify(t.wdParams).toLowerCase());["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf"].forEach((function(t){s[t]&&(r[t]=s[t])}))}var a=Object(i.a)({},t.rebootOverride);delete a.ackExpected,delete a["ui-language"],delete a.wdUserSession,delete a.rebootMode,delete a.documentUrl;var u=t.wopi;return{accessToken:u?{length:u.accessToken.length,expiry:u.expiry}:"N/A",bootParams:t.bootParams,build:Object(c.a)(),host:o,intent:t.intent,jsApiVersion:"v2",rebootOverride:a,region:Object(f.m)(t.appBaseUrl),sessionOrigin:t.hostInitDiagnostics?t.hostInitDiagnostics.entryPoint:void 0,sessionContext:t.sessionContext,throttling:t.throttling,ui:t.ui,viewMode:t.viewMode,meeting:t.meeting?{id:null===(e=t.meeting)||void 0===e?void 0:e.id,isPresenter:null===(n=t.meeting)||void 0===n?void 0:n.isPresenter}:void 0,wdParams:r}}function p(t){if(window.performance&&window.performance.getEntriesByType("resource")){var e=window.performance.getEntriesByType("resource"),n={},i={unixTimestamp:Date.now(),highResTimestamp:window.performance.now()};return e.forEach((function(t){var e=t.name.split("?")[0];if(e.indexOf(".js")>0||e.indexOf(".css")>0||e.indexOf(".aspx")>0){var i=e.substring(e.lastIndexOf("/"));i=i.indexOf("?")>0?i.substring(0,i.indexOf("?")):i,n[i]={startTime:t.startTime,fetchStart:t.fetchStart,requestStart:t.requestStart,responseStart:t.responseStart,responseEnd:t.responseEnd,cacheHit:v(t),transferSize:"transferSize"in t?t.transferSize:-1}}})),{coreResourceDownloadMap:n,referenceTimestampMarkers:i}}t.ULS.Rn(544494928,o.a.Z,r.a.Info,"Browser does not support getEntriesByType in the Performance API.")}function v(t,e){return void 0===e&&(e=100),"transferSize"in t?0===t.transferSize?1:0:void 0!==t.responseEnd&&void 0!==t.fetchStart&&t.responseEnd-t.fetchStart<e?1:0}function m(){var t={perfNowSupported:a.c,browser:s.a[Object(s.c)()],touchMode:Object(s.g)(),highContrast:Object(s.d)(),windows10x:Object(s.h)()};try{var e=window.navigator,n=e.connection||e.mozConnection||e.webkitConnection;n&&(t.netDownlink=n.downlink,t.netDownlinkMax=n.downlinkMax,t.netEffectiveType=n.effectiveType,t.netRtt=n.rtt,t.netSaveData=n.saveData,t.netType=n.type),t.deviceMemory=e.deviceMemory,t.logicalProcessors=e.hardwareConcurrency}catch(t){}return t}function b(t){try{var e=t.hostInitDiagnostics;t.logger.ULS.Rn(558155803,o.a.Z,r.a.Info,"HostInitDiagnostics: "+(e?JSON.stringify(e):"N/A")),t.logger.ULS.Rn(596444237,o.a.Z,r.a.Info,JSON.stringify({session:l(t),client:t.clientDiagnostics}))}catch(e){t.logger.ULS.Rn(558155804,o.a.Z,r.a.Error,"Failed to log init info: ".concat(Object(u.b)(e)))}}var O;function w(t){return/sharepoint/i.test(t)}function g(t,e){var n=t;return n&&Object.keys(O).includes(n)||(n="Normal"),O[n]>=O[e]}!function(t){t[t.Unknown=0]="Unknown",t[t.Normal=1]="Normal",t[t.Minor=2]="Minor",t[t.Medium=3]="Medium",t[t.Major=4]="Major",t[t.Critical=5]="Critical"}(O||(O={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return a}));var i=n(0),o=n(1),r=n(8),s=n(21);function c(t,e){return{isFeatureEnabled:function(n){return function(t,e,n){if(!e)return;try{return e(t)}catch(t){n&&n.ULS.Rn(594883024,i.a.Z,o.a.Error,"IsFeatureEnabled callback error: "+Object(r.b)(t))}return}(n,t,e)}}}function a(t,e){var n={};if(Object.keys(s.a).forEach((function(e){var i=t.isFeatureEnabled(s.a[e]);void 0!==i&&(n[s.a[e]]=i?"1":"0")})),e&&e.wdFlights)for(var i=0,o=e.wdFlights.toLowerCase().split(",");i<o.length;i++){var r=o[i];"et-treatment"!==r&&"et-control"!==r||(n[s.a.An]="et-treatment"===r?"1":"0")}return JSON.stringify(n)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(0),o=n(1),r=function(){function t(t,e){this.ms=function(){return s(t,"OnBeforeUnload",e)},this.bs=function(){return s(t,"OnPageHide",e)},this.Os=function(){return s(t,"VisibilityChange_"+document.visibilityState,e)},this.ws=function(){return s(t,"OnUnload",e)},window.addEventListener("beforeunload",this.ms,{capture:!0,once:!0}),window.addEventListener("pagehide",this.bs,{capture:!0}),window.addEventListener("visibilitychange",this.Os,{capture:!0}),window.addEventListener("unload",this.ws,{capture:!0,once:!0})}return t.prototype.dispose=function(){window.removeEventListener("beforeunload",this.ms,{capture:!0}),window.removeEventListener("pagehide",this.bs,{capture:!0}),window.removeEventListener("visibilitychange",this.Os,{capture:!0}),window.removeEventListener("unload",this.ws,{capture:!0})},t}();function s(t,e,n){t.ULS.Rn(595957843,i.a.Z,o.a.Info,"Page lifecycle: ".concat(e," fired")+(n?", flushing logger":"")),n&&t.ULS.flush()}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n(3),o=n(0),r=n(1),s=["https://augloop.office.com.office.prod.zensar.myshn.net/v2","api://visio.officeapps.live.com.office.prod.zensar.myshn.net/va/00695ed2-3202-4156-8da1-69f60065e255","394866fc-eedb-4f01-8536-3ff84b16be2a","https://officescripting.microsoft.com.office.prod.zensar.myshn.net","https://nleditor.osi.office.net.office.prod.zensar.myshn.net/nleditor","e03a13ee-9730-4cae-8525-47559c8cf18a"],c=function(){function t(t){var e=this;this.gs={},this.js=[],this.Ss=function(t){if(t&&t.origin)try{var n=t.data;if("string"==typeof n&&n.includes("AddinTrustedOrigin")){var i=JSON.parse(n),s=i.AddinTrustId;s&&"AddinTrustedOrigin"===i.MessageId&&(e.oi.ULS.Rn(560754784,o.a.Z,r.a.Info,"didReceiveMessage addinTrustId ".concat(s)),e.gs[s]=t.origin,e.js.forEach((function(e){e(s,t.origin)})))}}catch(t){e.oi.ULS.Rn(560754785,o.a.Z,r.a.Error,"AuthTokenTrustValidator didReceiveMessage failed")}},this.oi=t,window.addEventListener("message",this.Ss)}return t.prototype.isResourceTrustedForMessage=function(t){return Object(i.b)(this,void 0,void 0,(function(){var e,n,c,u,f,d,h,l,p=this;return Object(i.d)(this,(function(i){switch(i.label){case 0:return t&&t.Resource?(e=t.Resource,n=t.AddinTrustId,(c=function(t){if(!t)return!1;for(var e=t.toLowerCase(),n=0,i=s;n<i.length;n++){var o=i[n];if(o===e||"".concat(o,"/")===e)return!0}return!1}(e))||!n?[2,c]:this.gs[n]?[2,a(e,this.gs[n])]:(f=new Promise((function(t){u=function(i,o){n===i&&t(a(e,o))},p.js.push(u)})),d=-1,2e3,h=new Promise((function(t){d=window.setTimeout((function(){p.oi.ULS.Rn(560754786,o.a.Z,r.a.Warning,"isResourceTrustedForMessage - timeout waiting for addinTrustId: ".concat(n)),t(!1)}),2e3)})),[4,Promise.race([f,h])])):[2,!1];case 1:return l=i.sent(),this.js=this.js.filter((function(t){return t!==u})),window.clearTimeout(d),[2,l]}}))}))},t.prototype.dispose=function(){this.gs={},this.js=[],window.removeEventListener("message",this.Ss)},t}();function a(t,e){try{if(!t||!e)return!1;for(var n=/[?&#%\\]/,i=0;i<t.length;i+=1){var o=t.charCodeAt(i);if(o<33||o>126)return!1;var r=t.charAt(i);if(n.test(r))return!1}var s=t;"api:"===s.substring(0,"api:".length).toLowerCase()&&(s="".concat("https:").concat(s.substring("api:".length)));var c=new URL(s);return"https:"===c.protocol&&e.toLowerCase()===c.origin.toLowerCase()}catch(t){return!1}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var i=n(45),o=n(32);var r=n(37),s=function(){function t(t,e,n,r,s,c){var a=this;!function(t){if(!t)throw new TypeError("SessionInitParams");if(!t.hostSessionId)throw new TypeError("HostSessionId")}(n);this.Is=new i.a(t,e,n,r,this,c,(function(t,e){return s({type:t,data:e,session:a})})),this.Is.state=o.a.Initialized}return Object.defineProperty(t.prototype,"id",{get:function(){return this.Is.sessionId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"diagnostics",{get:function(){return this.Is.diagnostics},enumerable:!1,configurable:!0}),t.prototype.run=function(t,e,n){return this.Is.run(t,e,n)},t.prototype.boot=function(t,e){return this.Is.run(r.a.boot,t,e)},t.prototype.dispose=function(t){return this.Is.run(r.a.dispose,void 0,t)},t}(),c=n(113),a=n(49),u=n(15),f=n(19);n.d(e,"a",(function(){return d}));var d=function(){function t(t,e,n){var i=this;this.sessions=[],this.containers=[],this.ys=function(t){i.Ts.dispatch(t)},function(t){if(!t)throw new TypeError("ApplicationInitParams");var e=t.host;if(!e||!e.storageHostName)throw new TypeError("HostInfo");var n=t.user;if(!n||null==n.id)throw new TypeError("UserInfo")}(t),this._s=t,this.Cs=e,this.Ps=n,this.Ts=new a.a,Object(u.b)()}return Object.defineProperty(t.prototype,"name",{get:function(){return this.Cs.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return Object(f.a)()},enumerable:!1,configurable:!0}),t.prototype.addEventListener=function(t){this.Ts.add(t)},t.prototype.removeEventListener=function(t){this.Ts.remove(t)},t.prototype.createContainer=function(t){var e="WacFrame_".concat(this.Cs.name,"_").concat(this.containers.length),n=new c.a(t,e);return this.containers.push(n),n},t.prototype.createSession=function(t){var e=new s(this._s,this.Cs,t,this,this.ys,this.Ps);return this.sessions.push(e),e},t.prototype.dispose=function(t){var e=this,n=this.sessions.map((function(e){return e.dispose(t).catch((function(t){}))}));return Promise.all(n).then((function(t){return e.Ts.removeAll(),e.sessions=[],e.containers=[],{completion:"success"}}))},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(48),o=n(19);function r(t,e,n){!function(t,e,n,o){void 0===o&&(o=!0);var r={type:e,payloadJson:JSON.stringify(n)};Object(i.a)(JSON.stringify(r),t,o)}(t,"JSAPI_STATE",{application:e,build:Object(o.a)(),state:n})}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(8),o=n(11);function r(){var t=new Uint8Array(31),e=function(t){var e={crypto:!1,perfNow:!1,exceptions:[]},n=window.crypto||window.msCrypto;if(n){e.crypto=!0;try{return n.getRandomValues(t),e}catch(t){e.exceptions.push("crypto: ".concat(Object(i.b)(t)))}}e.perfNow=o.c;for(var r=0;r<t.length;r+=1){try{if(o.c){var s=Math.floor(100*window.performance.now())%10;(s<0||s>9)&&(s=0);for(var c=0;c<s;c+=1)Math.random()}}catch(t){e.exceptions.push("Math.random: ".concat(Object(i.b)(t)))}t[r]=Math.floor(16*Math.random())}return e}(t),n=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var i=15&t[n];return n+=1,("x"===e?i:3&i|8).toString(16)})),e]}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"d",(function(){return u})),n.d(e,"c",(function(){return f})),n.d(e,"b",(function(){return d})),n.d(e,"e",(function(){return h}));var i,o=n(0),r=n(1),s=n(7),c=n(15),a=n(8);!function(t){t.Fi="access_token",t.Ni="access_token_ttl",t.xi="bundleSrc",t.Mi="bundleStaleness",t.Yi="DocID",t.Rs="SiteID",t.As="WebID",t.to="ETag",t.Gi="feature_status",t.Hi="fileExtension",t.ki="fileGetUrl",t.Di="customFontCatalogUrl",t.Ji="fileName",t.Bi="fileSize",t.Us="forceSLR",t.Es="frameHeightPx",t.Ws="frameWidthtPx",t.Fs="highContrast",t.Zi="highDpi",t.qi="host_diagnostics",t.Xi="hostName",t.Ki="huictrls",t.zi="owner_id",t.Li="sc",t.$i="softBlockedBrowser",t.Qi="templateUrl",t.Ns="touchMode",t.Vi="user_id",t.xs="hfck",t.Ms="hfcv",t.ks="timeZoneId",t.Ds="darkCssMedia",t.eo="caae",t.no="meetingId",t.io="meetingTitle",t.oo="meetingType",t.Hs="scheduledStartTime",t.ro="scheduledEndTime",t.ao="isPresenter",t.co="meetingOrganizerId",t.so="meetingJoinUrl"}(i||(i={}));function u(t,e,n,i,o,r){void 0===o&&(o="unset"),void 0===r&&(r="unset"),t.style.top="0",t.style.bottom="0",t.style.left="0",t.style.right="0",t.style.height="100%",t.style.width="100%",t.style.minHeight=o,t.style.minWidth=r;var s=t.ownerDocument,c=s.createElement("iframe");c.id=e,c.name=e,c.src="",c.title="Office on the web Frame",c.marginWidth="0",c.marginHeight="0",c.style.top="0",c.style.bottom="0",c.style.left="0",c.style.right="0",c.style.height="100%",c.style.width="100%",c.style.minHeight=o,c.style.minWidth=r,c.style.display="block",c.style.position="absolute",c.style.backgroundColor="transparent",c.style.border="none",c.frameBorder="0",c.setAttribute("allowfullscreen","true"),c.setAttribute("allowTransparency","true"),c.setAttribute("allow",n);var a=i?s.createElement("div"):void 0;return a?(a.style.top="0",a.style.bottom="0",a.style.left="0",a.style.right="0",a.style.height="100%",a.style.width="100%",a.style.minHeight=o,a.style.minWidth=r,a.style.backgroundColor="#393a3d",a.style.backfaceVisibility="hidden",a.appendChild(c),t.appendChild(a)):t.appendChild(c),c}function f(t,e,n,i,o){var r=t.ownerDocument,s=r.createElement("form");for(var c in s.id=n,s.name=n,s.action=i,s.target=e,s.method="POST",o){var a=r.createElement("input");a.type="hidden",a.name=c,a.value=o[c],s.appendChild(a)}return t.appendChild(s),s}function d(t,e){Object(s.a)(e,i.Es,String(t.offsetHeight)),Object(s.a)(e,i.Ws,String(t.offsetWidth)),Object(s.a)(e,i.Ns,String(Object(c.g)())),Object(s.a)(e,i.Fs,String(Object(c.d)())),Object(s.a)(e,i.Us,String(Object(c.h)())),Object(s.a)(e,i.Ds,String(Object(c.i)()))}function h(t){try{return window===window.top||window.parent===window.top&&window.location.origin===window.top.origin}catch(e){return t&&t.ULS.Rn(591525084,o.a.Z,r.a.Info,"Trust check error: ".concat(Object(a.b)(e))),!1}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n(0),o=n(1),r=n(16),s=n(11),c=function(){function t(t,e,n,c,u){var f=this;this.Js=0,this.Bs=[];var d=e.getValue(r.a.Ve,!1);this.Js=Object(s.b)()+(u||e.getValue(r.a.Ne,3e5));var h=t?3e3:5e3;this.Vs=window.setInterval((function(){d&&n.ULS.Rn(595724178,i.a.Z,o.a.Info,"Boot_HeartBeat"),Object(s.b)()>f.Js&&(f.stop(),a(n),c&&c())}),e.getValue(r.a.Be,h)),this.Bs.push(window.setTimeout(a,e.getValue(r.a.xe,6e4),n,1)),this.Bs.push(window.setTimeout(a,e.getValue(r.a.Me,18e4),n,2))}return t.prototype.stop=function(){this.Js=0,this.Vs&&(window.clearInterval(this.Vs),this.Vs=void 0),this.Bs.forEach((function(t){window.clearTimeout(t)})),this.Bs=[]},t}();function a(t,e){t.ULS.Rn(594901218,i.a.Z,o.a.Warning,"Boot_NotComplete_".concat(e||"Final")),t.ULS.flush()}},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return s}));var i=n(9),o=n(17);function r(t){var e=window.navigator;if(e&&e.virtualKeyboard&&void 0!==e.virtualKeyboard.overlaysContent&&window===top)return e.virtualKeyboard.overlaysContent=t}var s=function(t,e,n,s,c){return t!==i.a.he?Promise.reject("Wrong flow"):new Promise((function(t){r(e.overlayContent),n.container&&n.container.postMessage(o.a.jn,void 0),t({completion:"success"})}))}},function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return u}));var i=n(9),o=n(17),r=n(0),s=n(1),c=n(27);function a(t){return Object(c.b)(t.hostKey)}var u=function(t,e,n,c,u){return t!==i.a.qt?Promise.reject("Wrong flow"):new Promise((function(t){var i=e.hostKey;n.logger.ULS.Rn(574408915,r.a.Z,s.a.Info,"getHostKeyValue ".concat(i));var c=a(e);n.container&&c&&n.container.postMessage(o.a.on,{hostKey:i,hostValue:c}),t({completion:"success"})}))}},function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return a}));var i=n(9),o=n(0),r=n(1),s=n(27);function c(t){Object(s.d)(t.hostKey,t.hostValue,s.c)}var a=function(t,e,n,s,a){return t!==i.a.me?Promise.reject("Wrong flow"):new Promise((function(t){var i=e.hostKey,s=e.hostValue;n.logger.ULS.Rn(574408914,o.a.Z,r.a.Info,"storeHostKeyValue ".concat(i,": ").concat(s)),c(e),t({completion:"success"})}))}},function(t,e,n){"use strict";function i(t,e,n,i){var o=new XMLHttpRequest;for(var r in o.onreadystatechange=function(){if(o&&4===o.readyState){if(void 0===o.status||0===o.status)return;try{i&&i(o)}finally{null!=o&&(o.onreadystatechange=function(){})}}},o.open("POST",t),n)o.setRequestHeader(r,n[r]);o.send(e)}n.d(e,"a",(function(){return i}))},function(t,e,n){"use strict";var i;!function(t){t[t.Trace=0]="Trace",t[t.Assert=1]="Assert"}(i||(i={}));var o=n(1);function r(t,e,n,i){var o=[],r=t.map((function(t){return function(t,e,n){var i={};if(i.G=t.tag,i.T=t.timestamp-e,i.M=t.message,i.C=t.category,t.correlationId){var o=n.findIndex((function(e){return e===t.correlationId}));o<0&&(o=n.push(t.correlationId)-1),i.I=o}var r=1e3*t.type+t.level;return i.D=r,i}(t,i,o)})),s=function(t,e,n,i,o){var r={};r.T=t,r.L=e,r.S=n,r.I=i,o&&o.length>0&&(r.W=o);return r.V=1,r}(i,r,e,n,o);return JSON.stringify(s)}var s,c=n(48),a=n(11),u=n(19),f=function(){function t(t){var e=this;this.zs=3e4,this.Ls=30,this.qs=0,this.Gs=[],this.Ks=Object(a.a)(),this.Zs="",this.$s=0,this.flushOnClose=function(){e.Xs(!1,!1)},this.flush=function(){e.Qs()},this.Qs=function(){window.setTimeout((function(){return e.Xs(!0,!0)}),0)},this.Xs=function(t,n){var i=Object(a.b)();if(window.clearTimeout(e.Oi),e.Ys){if(e.Gs.length>0){e.qs+=1;var o=r(e.Gs.splice(0,t?e.Ls:e.Gs.length),e.Zs,e.qs,e.Ks);Object(c.a)(o,e.Ys,n),e.Ks=Object(a.a)()}t&&(e.Oi=window.setTimeout(e.Qs,e.Gs.length>e.Ls?1e3:e.zs)),e.$s+=Object(a.b)()-i}},t&&this.configure(t)}return t.prototype.getTimeSpentLogging=function(){return this.$s},t.prototype.addLoggingTime=function(t){this.$s+=t},t.prototype.configure=function(t){var e=this,n=Object(a.b)();if(t.uploadCadenceInMs&&(this.zs=t.uploadCadenceInMs),t.uploadTriggerSize&&(this.Ls=t.uploadTriggerSize),t.sessionId&&(this.Zs=t.sessionId),t.remoteUlsEndpoint){if(!t.sessionId&&this.Ys)throw new Error("Remote ULS endpoint is already set");this.Ys=t.remoteUlsEndpoint+"?usid="+this.Zs+"&officeserverversion="+Object(u.a)(),this.Ks=Object(a.a)(),window.setTimeout((function(){return e.Xs(!0,!0)}),0)}this.$s+=Object(a.b)()-n},t.prototype.handleTrace=function(t){var e=Object(a.b)();t.message.length>3072&&(t.message=t.message.substring(0,3072-"... [Trimmed]".length)+"... [Trimmed]"),this.Gs.push(t),(this.Gs.length>this.Ls||t.level===o.a.Error)&&this.Qs(),this.$s+=Object(a.b)()-e},t}(),d=[];var h=n(16);n.d(e,"a",(function(){return l}));function l(t){var e=new f(t);function n(t,n,o,r){var s=Object(a.b)();if(!function(t){return 1===d[t]}(t)){var c={timestamp:Object(a.a)(),category:n,tag:t,level:o,type:i.Trace,message:r,correlationId:""};e.addLoggingTime(Object(a.b)()-s),e.handleTrace(c)}}return{ULS:{Rn:function(t,e,i,o){n(t,e,i,o)},shipAssertTag:function(t,e,i,r){i&&n(t,e,o.a.Error,r)},debugAssertTag:function(t,e,n,i){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:e.flush,flushOnClose:e.flushOnClose,setCorrelationId:function(){}},configure:function(t){e.configure(t)},settingsChangeHandler:function(t){var n,i;n=t.Fe.getValue(h.a.De,""),i=t.Fe.getValue(h.a.ke,""),s&&i===s||(d=[],s=i,n&&n.split(",").forEach((function(t){var e=parseInt(t,10);e&&(d[e]=1)}))),e.configure({uploadCadenceInMs:t.Fe.getValue(h.a.ze,6e4)})},getTimeSpentLogging:function(){return e.getTimeSpentLogging()}}}},,,,,,,,,,,,function(t,e,n){"use strict";n.r(e),n.d(e,"Application",(function(){return d})),n.d(e,"Viewer",(function(){return h})),n.d(e,"createApplication",(function(){return l}));var i=n(36),o=n(86),r=n(38),s=n(35),c=n(46),a=n(47),u=n(2);n.d(e,"ApplicationEvents",(function(){return u.a}));var f=n(5);n.d(e,"DocRebootSupportMode",(function(){return f.b})),n.d(e,"CommandIds",(function(){return f.a})),n.d(e,"EventIds",(function(){return f.c})),n.d(e,"createCancellationToken",(function(){return f.d}));var d=new r.a(s.b,{forceSingleStepBoot:!1,preconnector:Object(i.a)(!0)}),h=new r.a(c.a,{forceSingleStepBoot:!0,useViewerInitializer:!0,preconnector:Object(i.a)(!0)}),l=function(t){var e={name:"Word",preconnector:Object(i.a)(!0)};return new o.a(t,e,a.a)}},,,function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),function(t){t.appReboot="appReboot",t.boot="boot",t.closeTab="closeTab",t.createNew="createNew",t.dispose="dispose",t.frameTrust="frameTrust",t.getAuthToken="getAuthToken",t.getHostKeyValue="getHostKeyValue",t.handleBootState="handleBootState",t.rename="rename",t.setOverlayContent="setOverlayContent",t.storeHostKeyValue="storeHostKeyValue",t.switchMode="switchMode",t.updateBootComplete="updateBootComplete"}(i||(i={}))},,,function(t,e,n){"use strict";var i=n(0),o=n(1),r=n(9),s=n(7),c=n(8),a=n(11),u=n(17),f=function(){function t(t,e,n){var a=this;this.ur="",this.dr="",this.lr=!1,this.pr=!1,this.hr=!1,this.tc=function(t){var e=!1,n=!0,f="",d=!1;if(a.ec&&a.ec.contentWindow&&(e=!0,n=t.source===a.ec.contentWindow),t.origin&&(d=(f=Object(s.h)(t.origin,2).toLowerCase())===a.dr),!a.lr&&(!a.pr||d&&n)||a.oi.ULS.Rn(593232850,i.a.Z,o.a.Info,"Window: available["+e+"] valid["+n+"]; Origin: valid["+d+"] expected["+a.dr+"] actual["+f+"]"),d&&(!a.hr||n)){var h;try{h=JSON.parse(t.data)}catch(t){return void a.oi.ULS.Rn(593232851,i.a.Z,o.a.Info,"Failed to parse event data: ".concat(Object(c.b)(t)))}var l=h.MessageId;if(l)if(a.oi.ULS.Rn(593232854,i.a.Z,o.a.Info,"Received message: ".concat(l,", correlation: ").concat(h.CorrelationId)),l!==r.a.Tt&&l!==r.a.Zt||a.setTargetOrigin(t.origin),h.Values&&h.Values.ackExpected&&a.postMessage(u.a.Ge,void 0,h.CorrelationId),a.nc)try{a.nc(h)}catch(t){a.oi.ULS.Rn(594556386,i.a.Z,o.a.Error,"Message handler error: ".concat(Object(c.b)(t)))}else a.oi.ULS.Rn(591933923,i.a.Z,o.a.Error,"No message handler");else(a.lr||a.pr)&&a.oi.ULS.Rn(593232853,i.a.Z,o.a.Info,"Missing message id")}},this.oi=e,this.setTargetOrigin(t),n&&this.setMessageHandler(n),window.addEventListener("message",this.tc,!1)}return t.prototype.setTargetOrigin=function(t){var e=Object(s.i)(t).toLowerCase();this.ur&&this.ur!==e&&this.oi.ULS.Rn(593232847,i.a.Z,o.a.Warning,"Updating origin: [".concat(Object(s.g)(this.ur),"]->[").concat(Object(s.g)(e),"]")),this.ur=e,this.dr=Object(s.h)(e,2),this.lr=Object(s.n)(e),this.pr=Object(s.o)(e)},t.prototype.setTargetFrame=function(t,e){this.ec=t,this.hr=!!e},t.prototype.setMessageHandler=function(t){this.nc=t},t.prototype.removeMessageHandler=function(){this.nc=void 0},t.prototype.postMessage=function(t,e,n){if(this.ec&&this.ec.contentWindow){this.oi.ULS.Rn(593232849,i.a.Z,o.a.Info,"Sending message: "+t);var r={MessageId:t,SendTime:Object(a.a)(),CorrelationId:n,Values:e};this.ec.contentWindow.postMessage(JSON.stringify(r),this.ur)}else this.oi.ULS.Rn(593232848,i.a.Z,o.a.Error,"Missing target to send message: "+t)},t.prototype.dispose=function(){window.removeEventListener("message",this.tc,!1),this.nc=void 0},t}();var d=n(89);n.d(e,"a",(function(){return h}));var h=function(){function t(t,e){!function(t){if(void 0===t||void 0===t.appendChild)throw TypeError("Container")}(t),this.ic=t,this.oc=e,this.rc=e+"_Form",this.cc=Object(d.e)()}return Object.defineProperty(t.prototype,"element",{get:function(){return this.ic},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"frameId",{get:function(){return this.oc},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"formId",{get:function(){return this.rc},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isTopFrameTrusted",{get:function(){return this.cc},enumerable:!1,configurable:!0}),t.prototype.boot=function(t,e,n,r,s){this.oi=n,this.ac=new f(t,n,this.nc);var c=s.useAdditionalDiv;this.uc&&!c?(this.uc.setAttribute("allow",r),this.oi.ULS.Rn(588793045,i.a.Z,o.a.Info,"Wac frame reused")):(this.uc=Object(d.d)(this.ic,this.oc,r,c,s.minHeight,s.minWidth),this.oi.ULS.Rn(588793046,i.a.Z,o.a.Info,"Wac frame created")),this.ac.setTargetFrame(this.uc),c&&(this.fc=this.uc.parentElement),Object(d.b)(this.uc,e),this.dc=Object(d.c)(this.ic,this.oc,this.rc,t,e),this.dc.submit()},t.prototype.setMessageHandler=function(t){this.nc=t,this.ac&&this.ac.setMessageHandler(t)},t.prototype.setWrapperPostMessage=function(t){this.hc=t},t.prototype.removeMessageHandler=function(){this.nc=void 0,this.ac&&this.ac.removeMessageHandler()},t.prototype.postMessage=function(t,e){this.hc?this.hc(t,e):this.ac&&this.ac.postMessage(t,e)},t.prototype.dispose=function(t,e){var n=this;return new Promise((function(i){if(n.dc&&(n.ic.removeChild(n.dc),n.dc=void 0),n.ac&&(n.ac.dispose(),n.ac=void 0,n.nc=void 0),n.hc&&(n.hc=void 0),n.oi=void 0,!n.uc||!n.fc&&t)i();else{var o=function(){n.fc?(n.fc.removeChild(n.uc),n.ic.removeChild(n.fc)):n.ic.removeChild(n.uc),n.uc=void 0,n.fc=void 0,i()};e?o():(n.uc.src="about:blank",window.setTimeout(o,0))}}))},t}()}]);

